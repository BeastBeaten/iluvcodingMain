define("controller/mobile/standard/common/common-controller",["angular"],function(e){var a=e.module("openwebApp.controller.common.commonModule",[]);a.controller("OrderIndexCtrl",["$rootScope","$scope","$state","$stateParams","OrderService",function(e,a,o,r,t){e.curRouter="order",a.cancel=function(){o.go(e.menu)},a.order=function(a){return"remote"==a&&Tools.prototype.isEmpty(e.userLoginId)?void o.go("login"):void o.go("order-query",{type:a})}}]),a.controller("OrderQueryCtrl",["$rootScope","$scope","$state","$stateParams","OrderService","PayService","MessageService","dialog",function(a,o,r,t,c,i,s,d){if("remote"==t.type&&Tools.prototype.isEmpty(a.userLoginId))return void r.go("login");o.data={queryType:t.type,memberId:a.userLoginId,code:a.code,billState:"success",already:"success",queryFlag:"1",iDisplayStart:0};var n=0,l=0,p=0,u=!0,m=!0,g=!0;o.orderList=[],o.orderList1=[],o.orderList0=[],o.orderList9=[],o.changeOrderType=function(e,a,r){o.data.queryFlag=r,o.data.billState=e,o.data.already=a,"remote"==o.data.queryType?(o.setOrderList([]),0==o.orderList.length&&o.queryOrder()):o.queryOrder()},o.queryFlag=function(){return"1"==o.data.queryFlag?0==o.orderList1.length:"0"==o.data.queryFlag?0==o.orderList0.length:0==o.orderList9.length},o.setOrderList=function(e){if("1"==o.data.queryFlag)if("remote"==o.data.queryType){if(0<e.length)for(var a=0;a<e.length;a++)o.orderList1.push(e[a]);o.orderList=o.orderList1}else o.orderList1=e;else if("0"==o.data.queryFlag)if("remote"==o.data.queryType){if(0<e.length)for(var a=0;a<e.length;a++)o.orderList0.push(e[a]);o.orderList=o.orderList0}else o.orderList0=e;else if("remote"==o.data.queryType){if(0<e.length)for(var a=0;a<e.length;a++)o.orderList9.push(e[a]);o.orderList=o.orderList9}else o.orderList9=e},o.queryLocalOrder=function(){var e=Tools.prototype.saveCookie("localOrder");Tools.prototype.isEmpty(e)||(o.data.billIdList=e.split(";"),o.queryFlag()?c.queryOrders(o.data,function(e){"success"==e.message&&0<e.data.length?(o.setOrderList(e.data),o.orderList=e.data):o.orderList=[]}):"1"==o.data.queryFlag?o.orderList=o.orderList1:"0"==o.data.queryFlag?o.orderList=o.orderList0:o.orderList=o.orderList9)},o.queryRemoteOrder=function(){return Tools.prototype.isEmpty(a.userLoginId)?void(o.orderList=[]):o.getCanLoadMore()?(o.data.iDisplayStart=o.getPageNo(),void c.queryOrderInfo(o.data,function(e){"success"==e.message&&0<e.data.length?(o.setOrderList(e.data),o.setCanLoadMore(!0)):(0==o.getPageNo()&&(o.orderList=[]),o.setCanLoadMore(!1))})):void o.setOrderList([])},o.initMonth=function(){o.dateList=[];for(var e=new Date,a=null,r=0;6>r;r++){var t={};a=new Date(e.getFullYear(),e.getMonth()+1-r,0),t.year=a.getFullYear(),t.month=a.getMonth(),o.dateList.push(t)}o.data.startYear=o.dateList[0].year,o.data.startMonth=parseInt(o.dateList[0].month)},"remote"==o.data.queryType&&o.initMonth(),o.chooseTime=function(a){e.forEach(o.dateList,function(e,r){e.month==a&&(o.data.startMonth=parseInt(a),o.data.startYear=e.year)}),o.orderList=[],o.orderList1=[],o.orderList0=[],o.orderList9=[],n=0,l=0,p=0,u=!0,m=!0,g=!0,o.queryRemoteOrder()},o.getPageNo=function(){return"1"==o.data.queryFlag?l:"0"==o.data.queryFlag?n:p},o.addPageNo=function(){"1"==o.data.queryFlag?l++:"0"==o.data.queryFlag?n++:p++},o.getCanLoadMore=function(){return"1"==o.data.queryFlag?m:"0"==o.data.queryFlag?u:g},o.setCanLoadMore=function(e){"1"==o.data.queryFlag?m=e:"0"==o.data.queryFlag?u=e:g=e},o.queryOrder=function(){"remote"==o.data.queryType?o.queryRemoteOrder():o.queryLocalOrder()},o.queryOrder(),o.getCardName=function(e){return e.replace(/\d+\u5143/g,"")},o.loadMore=function(){return Tools.prototype.isEmpty(a.userLoginId)?void(o.orderList=[]):void(o.getCanLoadMore()&&(0!=o.getPageNo()||0!=o.orderList.length)&&(o.addPageNo(),o.queryRemoteOrder()))},o.getCurMenu=function(){return a.menu.indexOf("game")>-1?"gamerecharge":a.menu.indexOf("gift")>-1?"giftCardrecharge":a.menu.indexOf("vip")>-1?"viprecharge":a.menu.indexOf("public")>-1?"publicrecharge":a.menu},o.goPay=function(e,r){if(1==a.userData.payList.length){var t=o.getCurMenu(),c={orderNo:e,bankCode:a.userData.payList[0].bankCode,payTypeId:a.userData.payList[0].payTypeId,payType:a.userData.payList[0].payType,returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/"+t,code:a.code,memberId:a.userLoginId};"0820"==c.bankCode&&(c.payoutName=r),i.getPayUrlForMobile(c,function(e){"success"==e.message?location.href=e.data[0]:(o.errorData.errorMsg=s.errorMsg.commonMsg.pay_error,d.showTip({template:o.errorData.errorMsg}))})}}}]),a.controller("LoginCtrl",["$rootScope","$scope","$state","$stateParams","$cookieStore","$interval","MessageService","GavinService","MemberService",function(e,a,o,r,t,c,i,s,d){a.data={mobileNo:"",verifyCode:"",imageCode:"",randomId:"",code:e.code},a.idenCodeData={isGet:!1,title:"获取验证码",getImageCode:!1,imageCodeUrl:""},a.errorData={errorMsg:""};var n=t.get(e.code+"loginSeconds"),l=t.get(e.code+"loginSecondTime"),p=(new Date).getTime();if(!Tools.prototype.isEmpty(l)&&p-parseInt(l)>=6e4&&(n=0,t.remove(e.code+"loginSecondTime")),!Tools.prototype.isEmpty(n)&&0<parseInt(n)){a.idenCodeData.isGet=!0,n=parseInt(n);var u=c(function(){0==n?(c.cancel(u),a.idenCodeData.isGet=!1,a.idenCodeData.title="获取验证码",t.remove(e.code+"loginSeconds")):(a.idenCodeData.title="再次获取"+n,n--,t.put(e.code+"loginSeconds",n))},1e3)}a.checkTelPho=function(e){"1"==e?($("#telPho")[0].placeholder="",a.errorData.errorMsg=""):"2"==e?Tools.prototype.isEmpty(a.data.mobileNo)?$("#telPho")[0].placeholder="请输入手机号码":Tools.prototype.isMobileNo(a.data.mobileNo)?a.errorData.errorMsg="":a.errorData.errorMsg=i.errorMsg.commonMsg.phone_format_error:"3"==e&&(a.data.mobileNo=a.data.mobileNo.replace(/\D/g,""),Tools.prototype.isEmpty(a.data.mobileNo)||11<a.data.mobileNo.length&&(a.data.mobileNo=a.data.mobileNo.substr(0,11)))},a.checkCode=function(e){"1"==e?$("#verifyCode")[0].placeholder="":"2"==e?Tools.prototype.isEmpty(a.data.verifyCode)?$("#verifyCode")[0].placeholder="请输入短信验证码":a.errorData.errorMsg="":"3"==e&&(a.data.verifyCode=a.data.verifyCode.replace(/\D/g,""))},a.checkImageCode=function(e){"1"==e?$("#imageCode")[0].placeholder="":"2"==e?Tools.prototype.isEmpty(a.data.imageCode)?$("#imageCode")[0].placeholder="请输入验证字符":a.errorData.errorMsg="":"3"==e&&(a.data.imageCode=a.data.imageCode.replace(/\D/g,""))},a.checkForm=function(e){return Tools.prototype.isEmpty(a.data.mobileNo)?(a.errorData.errorMsg=i.errorMsg.commonMsg.no_phone,!1):Tools.prototype.isMobileNo(a.data.mobileNo)?"2"==e&&Tools.prototype.isEmpty(a.data.verifyCode)?(a.errorData.errorMsg=i.errorMsg.commonMsg.no_code,!1):"2"==e&&a.idenCodeData.getImageCode&&Tools.prototype.isEmpty(a.data.imageCode)?(a.errorData.errorMsg=i.errorMsg.commonMsg.no_image_code,!1):!0:(a.errorData.errorMsg=i.errorMsg.commonMsg.phone_format_error,!1)},a.getIdenCode=function(){if(a.checkForm("1")&&!a.idenCodeData.isGet){a.errorData.errorMsg="",a.idenCodeData.isGet=!0;var o=59,r=c(function(){0==o?(c.cancel(r),a.idenCodeData.isGet=!1,a.idenCodeData.title="获取验证码",t.remove(e.code+"loginSeconds")):(a.idenCodeData.title="再次获取"+o,o--,t.put(e.code+"loginSeconds",o))},1e3);t.put(e.code+"loginSecondTime",(new Date).getTime()),s.sendVerifyCode({telPho:a.data.mobileNo},function(e){"success"==e.message||("OverSendingLimit"==e.message?a.errorData.errorMsg=i.errorMsg.commonMsg.over_sending_limit:a.errorData.errorMsg=i.errorMsg.commonMsg.send_code_error)})}},a.flushImageCode=function(){a.idenCodeData.imageCodeUrl="/member/getImageCode?randomId="+Math.random().toString(36).substr(2)},a.login=function(){if(a.errorData.errorMsg="",a.checkForm("2")){a.errorData.errorMsg="";var r=new Date;a.data.randomId=r.getTime()+Math.random().toString(36).substr(2),d.login(a.data,function(r){"success"==r.message?(Tools.prototype.saveCookie(e.code+"randomId",null,{path:"/"}),Tools.prototype.saveCookie(e.code+"loginMobileNo",null,{path:"/"}),Tools.prototype.saveCookie(e.code+"randomId",r.resultCode,{expires:30,path:"/"}),Tools.prototype.saveCookie(e.code+"loginMobileNo",a.data.mobileNo,{expires:30,path:"/"}),t.remove("PublicLoginCity"),t.put("PublicLoginCity","PublicLoginCity"),e.loginStatus(),e.lastUrl&&!Tools.prototype.isEmpty(e.lastUrl)&&(e.lastForm.memberId=r.resultCode),o.go(e.curRouter)):"MAX_LIMIT"==r.message?(a.errorData.errorMsg=i.errorMsg.commonMsg.no_image_code,a.idenCodeData.getImageCode=!0,a.data.imageCode="",a.idenCodeData.imageCodeUrl="/member/getImageCode?randomId="+Math.random().toString(36).substr(2)):"IMAGECODE_ERROR"==r.message?(a.errorData.errorMsg=i.errorMsg.commonMsg.check_image_code_error,a.idenCodeData.imageCodeUrl="/member/getImageCode?randomId="+Math.random().toString(36).substr(2)):"NOT_MAX_LIMIT"==r.message?(a.idenCodeData.getImageCode=!1,a.data.imageCode="",a.errorData.errorMsg=i.errorMsg.commonMsg.check_code_error):(a.data.imageCode="",a.errorData.errorMsg=i.errorMsg.commonMsg.check_code_error,a.idenCodeData.getImageCode&&(a.idenCodeData.imageCodeUrl="/member/getImageCode?randomId="+Math.random().toString(36).substr(2)))})}},a.cancel=function(){e.lastUrl="","marketbills"==e.curRouter&&"58"==e.code?o.go("marketIndex"):o.go(e.curRouter)}}]),a.controller("MarketCtrl",["$rootScope","$scope","$state","$stateParams","$ionicModal","dialog","MarketService","ProductService",function(a,o,r,t,c,i,s,d){return Tools.prototype.isEmpty(a.userLoginId)?void r.go("login"):(a.marketInfo.userId=a.userLoginId,a.marketInfo.getDefaultFlag=!1,o.data={code:a.code,userId:a.userLoginId,category:t.category,isShowBind:!1,message:"",CDKey:"",billInfo:"",billId:"",title:"",cash:""},o.cancel=function(e){"1"==e?r.go(a.menu):(o.data.isShowBind=!1,o.data.billInfo="")},o.getMarketBillDesc=function(e,o){var r;if("3"!=e&&-1!=e.indexOf("3")){var t,c,i;switch(e){case"3A":t="移动",c=d.getFaceValueForCM;break;case"3B":t="联通",c=d.getFaceValueForCU;break;case"3C":t="电信",c=d.getFaceValueForCT}for(var s=0;s<c.length;s++)if(o==c[s].perValue){i=c[s].flowValue;break}r="OCP"==a.marketInfo.marketPayType?"可支付"+i+t+"流量及以下充值":"OCP&OLP2"==a.marketInfo.marketPayType?"限"+i+t+"流量使用":"满"+i+t+"流量充值使用"}else r="OCP"==a.marketInfo.marketPayType?"可支付"+o+"元及以下面值":"OCP&OLP2"==a.marketInfo.marketPayType?"限"+o+"元面值使用":"满"+o+"元面值使用";return r},o.initMarketBills=function(){Tools.prototype.isEmpty(o.marketBills)?o.marketBills="":e.forEach(o.marketBills,function(e,r){Tools.prototype.isEmpty(a.marketInfo.billId)||e.billId!=a.marketInfo.billId?e.choosed=!1:(e.choosed=!0,o.data.billId=e.billId,o.data.title="-"+e.cash+"元",o.data.cash=e.cash),e.desc=o.getMarketBillDesc(e.templateCateId,e.faceValue),"psbc"==a.code?(e.templateCateName="话费、加油卡","0"==e.consumerState&&"1"==e.state&&-1!=a.marketInfo.category.indexOf(o.data.category)?"OCP"==a.marketInfo.marketPayType&&(!Tools.prototype.isEmpty(a.marketInfo.faceValue)&&parseFloat(a.marketInfo.faceValue)<=parseFloat(e.cash)?e.isActive=!0:e.isActive=!1):e.isActive=!1):"0"==e.consumerState&&"1"==e.state&&-1!=o.data.category.indexOf(e.templateCateId)&&-1!=a.marketInfo.category.indexOf(e.templateCateId)?"OCP"==a.marketInfo.marketPayType?!Tools.prototype.isEmpty(a.marketInfo.faceValue)&&parseFloat(a.marketInfo.faceValue)<=parseFloat(e.cash)?e.isActive=!0:e.isActive=!1:"OCP&OLP2"==a.marketInfo.marketPayType?Tools.prototype.isEmpty(a.marketInfo.faceValue)||parseFloat(a.marketInfo.faceValue)!=parseFloat(e.faceValue)?e.isActive=!1:e.isActive=!0:!Tools.prototype.isEmpty(a.marketInfo.faceValue)&&parseFloat(a.marketInfo.faceValue)>=parseFloat(e.faceValue)?e.isActive=!0:e.isActive=!1:e.isActive=!1})},o.getMarketBills=function(){s.getMarketBills({code:a.code,userId:a.userLoginId},function(e){"success"==e.message&&(o.marketBills=e.data),o.initMarketBills()})},o.getMarketBills(),o.chooseBill=function(a){e.forEach(o.marketBills,function(e,r){a==e.billId?e.isActive?(e.choosed=!e.choosed,e.choosed?(o.data.billId=e.billId,o.data.title="-"+e.cash+"元",o.data.cash=e.cash):(o.data.billId="",o.data.title="不使用",o.data.cash="")):"0"==e.consumerState&&"1"==e.state&&i.showTip({template:"请先选择合适的面值"}):e.choosed=!1})},o.getMarketBillByCDKey=function(){s.getMarketBillByCDKey({code:a.code,CDKey:o.data.CDKey,userId:a.userLoginId},function(e){"success"==e.message?(o.data.billInfo=e.data[0],"OCP"==a.marketInfo.marketPayType?o.data.billInfo.desc="可支付"+o.data.billInfo.faceValue+"元及以下面值":o.data.billInfo.desc="满"+o.data.billInfo.faceValue+"元面值使用"):"HasBind"==e.message?(o.data.billInfo="",o.data.message="抵用券已绑定!"):(o.data.billInfo="",o.data.message="未查询到相关抵用券信息，请核对抵用券号!"),o.data.isShowBind=!0})},o.bindBill=function(){return Tools.prototype.isEmpty(o.data.billInfo)?(o.data.billInfo="",void(o.data.isShowBind=!1)):void s.bindMarketBill({billId:o.data.billInfo.billId,userId:a.userLoginId},function(e){"success"==e.message?(o.getMarketBills(),o.data.CDKey="",o.data.isShowBind=!1):"HasBind"==e.message?(o.data.billInfo="",o.data.message="抵用券已绑定!"):(o.data.billInfo="",o.data.message="抱歉，绑定失败，请稍后重试!")})},o.confirm=function(){return Tools.prototype.isEmpty(o.data.CDKey)?(a.marketInfo.billId=o.data.billId,a.marketInfo.title=o.data.title,a.marketInfo.cash=o.data.cash,void r.go(a.menu)):void o.getMarketBillByCDKey()},c.fromTemplateUrl("../../../partials/mobile/standard/common/market-desc-standard.html",{scope:o,focusFirstInput:!1}).then(function(e){o.model=e}),o.$on("$destroy",function(){o.model.remove()}),o.showRules=function(){o.model.show()},o.agreeRules=function(){o.model.hide()},void(o.clearCDKey=function(){Tools.prototype.isEmpty(o.data.CDKey)||(o.data.CDKey="")}))}]),a.controller("RechargeDescCtrl",["$rootScope","$scope","$state",function(e,a,o){a.indexNum="",Tools.prototype.isEmpty(e.rechargeDesc)&&o.go(e.menu),a.indexNum=e.rechargeDesc.length+1}])}),define("controller/mobile/standard/category/phone-controller",["angular"],function(e){var a=e.module("openwebApp.controller.phone.phoneModule",[]);a.controller("PhoneRechargeCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","MessageService","ProductService","OrderService","PayService","MenuService",function(a,o,r,t,c,i,s,d,n,l,p){var u=c(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);$("#copyright").html(u),a.userData.title="话费",a.menu="phonerecharge",a.curRouter=a.menu,a.rechargeDesc=p.phonerecharge.desc;var m=t.phoneNo;o.data={gameCount:"",cash:"",cityin:"",mobileType:"",hasCookie:!1,showCookie:!1,cookieData:""},o.payList=a.userData.payList,o.orderForm={orderType:"PHONERECHARGE",cardNum:"1",cardType:0,cardId:"",memberId:a.userLoginId,platform:"Mobile",code:a.code,ofLinkId:a.ofLinkId},o.errorData={phoneNoError:"",errorMsg:""};var g=Tools.prototype.saveCookie("phoneNoes");if(Tools.prototype.isEmpty(g)?(o.data.hasCookie=!1,o.phoneNoes=""):(o.data.hasCookie=!0,o.phoneNoes=g.split(";")),o.showCookie=function(){o.data.showCookie=!o.data.showCookie},o.clearCookie=function(){Tools.prototype.saveCookie("phoneNoes",null),o.phoneNoes="",o.data.hasCookie=!1,o.data.showCookie=!1},o.clearError=function(e){"1"==e?$("#gameCount")[0].placeholder="":"2"==e?(Tools.prototype.isEmpty(o.data.gameCount)?$("#gameCount")[0].placeholder="请输入或选择手机号码":(!Tools.prototype.isMobileNo(o.data.gameCount)||Tools.prototype.is170MobileNo(o.data.gameCount))&&(o.errorData.phoneNoError=s.errorMsg.orderMsg.phone_no_error),o.data.showCookie=!1):"3"==e?(o.data.gameCount="",o.data.showCookie=!1,o.errorData.phoneNoError="",o.errorData.errorMsg="",o.data.mobileType="",o.data.cityin="",o.clearFaceValue()):"4"==e&&(o.errorData.phoneNoError="",o.errorData.errorMsg="")},o.clearFaceValue=function(){o.orderForm.cardId="",o.orderForm.perValue="",e.forEach(o.faceList,function(e,a){e.id="",e.choosed=!1,e.stock=!1,e.price=""})},o.checkPhoneNo=function(r){return o.data.gameCount=o.data.gameCount.replace(/\D/g,""),o.clearError("4"),o.data.gameCount.length>11&&(o.data.gameCount=o.data.gameCount.substr(0,11)),Tools.prototype.isEmpty(o.data.gameCount)?void(o.data.showCookie=!1):(Tools.prototype.isEmpty(o.data.gameCount)||"1"!=r||(o.data.showCookie=!0),void(11==o.data.gameCount.length?(o.data.showCookie=!1,Tools.prototype.isMobileNo(o.data.gameCount)&&!Tools.prototype.is170MobileNo(o.data.gameCount)?("1"==r&&$("#gameCount").blur(),i.remove("PhoneRechargeNo"),i.put("PhoneRechargeNo",o.data.gameCount),d.getPhoneInfo(o.data.gameCount,function(r){"success"==r.message?(r.data[0].prvcin==r.data[0].cityin?o.data.cityin=r.data[0].prvcin:o.data.cityin=r.data[0].prvcin+" "+r.data[0].cityin,o.data.cityin+=r.data[0].mobileType,o.data.mobileType=r.data[0].mobileType,i.remove("PhoneRechargeInfo"),i.put("PhoneRechargeInfo",o.data.cityin),i.remove("PhoneTypeInfo"),i.put("PhoneTypeInfo",o.data.mobileType),e.forEach(o.faceList,function(e,t){d.getPhoneProduct({code:a.code,mobileType:o.data.mobileType,provinceName:r.data[0].prvcin,faceValue:e.value,phoneNo:o.data.gameCount},function(r){e.choosed=!1,"success"==r.message?(e.id=r.data[0].id,e.price=r.data[0].salePrice,e.stock=!0,Tools.prototype.isEmpty(a.faceValue)||e.value!=a.faceValue||o.chooseValue(e.id)):(e.id="",e.stock=!1,e.price="")})})):(o.data.mobileType="",o.data.cityin="")})):(o.data.mobileType="",o.data.cityin="",o.errorData.phoneNoError=s.errorMsg.orderMsg.phone_no_error)):(Tools.prototype.isEmpty(o.data.mobileType)&&Tools.prototype.isEmpty(o.data.cityin)||(o.data.cityin="",o.data.mobileType=""),o.errorData.phoneNoError="",o.clearFaceValue())))},"abc"==a.code?o.faceList=d.getABCPhoneFaceValueList:"psbc"==a.code?o.faceList=d.getPSBCPhoneFaceValueList:"ycpsbc"==a.code?o.faceList=d.getYCPSBCPhoneFaceValueList:o.faceList=d.getPhoneFaceValueList,o.choosePhoneNo=function(e){o.data.gameCount=e,o.data.showCookie=!1,o.checkPhoneNo("2")},o.chooseValue=function(t){if(o.data.showCookie=!1,"flowrecharge"==t)return(!Tools.prototype.isMobileNo(o.data.gameCount)||Tools.prototype.is170MobileNo(o.data.gameCount))&&(o.data.gameCount=""),a.initMarketInfo(),void r.go("flowrecharge",{phoneNo:o.data.gameCount});if(!Tools.prototype.isEmpty(o.data.mobileType)){if(Tools.prototype.isEmpty(t))return o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock,void(o.data.cash="");t!=o.orderForm.cardId&&a.initMarketInfo(),e.forEach(o.faceList,function(e,r){e.id==t?e.stock?(e.choosed=!0,o.orderForm.cardId=e.id,o.orderForm.perValue=e.value,o.data.cash=e.price,a.marketInfo.faceValue=o.orderForm.perValue,a.marketInfo.getDefaultFlag=!0,a.getDefaultMarketBill(o,"1")):(e.choosed=!1,o.orderForm.cardId="",o.orderForm.perValue="",o.data.cash="",a.marketInfo.faceValue=""):e.choosed=!1}),o.clearError("4")}},o.useMarketBill=function(e){return a.marketInfo.faceValue=o.orderForm.perValue,Tools.prototype.isEmpty(a.userLoginId)?void r.go("login"):void r.go("market",{category:e})},o.setCash=function(){Tools.prototype.isEmpty(a.marketInfo.billId)||(parseFloat(a.marketInfo.cash)>=parseFloat(o.data.cash)?o.data.cash="0":o.data.cash=(1e3*parseFloat(o.data.cash)-1e3*parseFloat(a.marketInfo.cash))/1e3)},Tools.prototype.isEmpty(m))if(Tools.prototype.isEmpty(i.get("PhoneRechargeNo")))Tools.prototype.isEmpty(a.rechargeAccount)||(o.data.gameCount=a.rechargeAccount,o.checkPhoneNo("2"));else{var y=i.get("PhoneRechargeNo");Tools.prototype.isEmpty(y)||(o.data.gameCount=y);var h=i.get("PhoneRechargeInfo"),f=i.get("PhoneTypeInfo");Tools.prototype.isEmpty(h)?(o.data.cash="",o.clearFaceValue()):(o.data.cityin=h,o.data.mobileType=f,e.forEach(o.faceList,function(e,a){e.choosed&&!Tools.prototype.isEmpty(e.price)&&(o.data.cash=e.price,o.orderForm.cardId=e.id,o.orderForm.perValue=e.value)}),Tools.prototype.isEmpty(o.data.cash)?(a.marketInfo.faceValue="",o.checkPhoneNo("2")):o.setCash())}else a.rechargeAccount="",a.faceValue="",o.data.gameCount=m,o.checkPhoneNo("2");o.takeOrder=function(e,r){return e.target.disabled=!0,o.data.showCookie=!1,Tools.prototype.isEmpty(o.data.gameCount)?(o.errorData.phoneNoError=s.errorMsg.commonMsg.no_phone,void(e.target.disabled=!1)):!Tools.prototype.isMobileNo(o.data.gameCount)||Tools.prototype.is170MobileNo(o.data.gameCount)?(o.errorData.phoneNoError=s.errorMsg.orderMsg.phone_no_error,void(e.target.disabled=!1)):Tools.prototype.isEmpty(o.orderForm.cardId)?(o.errorData.errorMsg=s.errorMsg.commonMsg.no_face_value,void(e.target.disabled=!1)):(a.bank=r,o.orderForm.gameCount=o.data.gameCount,o.orderForm.marketBillId=a.marketInfo.billId,void n.takeSaleOrder(o.orderForm,function(t){if("success"==t.message){a.saveCookies("phoneNoes",o.orderForm.gameCount);var c={orderNo:t.data[0].billId,bankCode:r.bankCode,payTypeId:r.payTypeId,payType:r.payType,returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/"+a.menu,code:a.code,memberId:a.userLoginId,marketBillId:o.orderForm.marketBillId};"0820"==c.bankCode&&(c.payoutName=t.data[0].cardName),l.getPayUrlForMobile(c,function(a){"success"==a.message?location.href=a.data[0]:o.errorData.errorMsg=s.errorMsg.commonMsg.pay_error,e.target.disabled=!1})}else o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock,e.target.disabled=!1}))},Tools.prototype.isEmpty(a.lastUrl)||n.takeSaleOrder(a.lastForm,function(e){if("success"==e.message){a.saveCookies("phoneNoes",o.lastForm.gameCount);var r={orderNo:e.data[0].billId,bankCode:a.bank.bankCode,payTypeId:a.bank.payTypeId,payType:a.bank.payType,returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/"+a.menu,code:a.code,memberId:a.userLoginId,marketBillId:a.lastForm.marketBillId};"0820"==r.bankCode&&(r.payoutName=e.data[0].cardName),l.getPayUrlForMobile(r,function(e){"success"==e.message?location.href=e.data[0]:o.errorData.errorMsg=s.errorMsg.commonMsg.pay_error,a.lastUrl="",a.lastForm=""})}else a.lastUrl="",a.lastForm="",o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock})}])}),define("controller/mobile/standard/category/flow-controller",["angular"],function(e){var a=e.module("openwebApp.controller.flow.flowModule",[]);a.controller("FlowRechargeCtrl",["$rootScope","$scope","$state","$stateParams","$cookieStore","$compile","MessageService","ProductService","OrderService","PayService","MenuService",function(a,o,r,t,c,i,s,d,n,l,p){var u=i(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);$("#copyright").html(u),a.userData.title="流量",a.menu="flowrecharge",a.curRouter=a.menu,a.rechargeDesc=p.flowrecharge.desc;var m=t.phoneNo;o.data={gameCount:"",cash:"",cityin:"",mobileType:"",hasCookie:!1,showCookie:!1,cookieData:""},o.errorData={phoneNoError:"",errorMsg:""},o.payList=a.userData.payList,o.orderForm={code:a.code,memberId:a.userLoginId,platform:"Mobile",ofLinkId:a.ofLinkId};var g=Tools.prototype.saveCookie("flowNoes");if(Tools.prototype.isEmpty(g)?(o.data.hasCookie=!1,o.phoneNoes=""):(o.data.hasCookie=!0,o.phoneNoes=g.split(";")),o.showCookie=function(){o.data.showCookie=!o.data.showCookie},o.clearCookie=function(){Tools.prototype.saveCookie("flowNoes",null),o.phoneNoes="",o.data.hasCookie=!1,o.data.showCookie=!1},o.clearError=function(e){"1"==e?$("#gameCount")[0].placeholder="":"2"==e?(Tools.prototype.isEmpty(o.data.gameCount)?$("#gameCount")[0].placeholder="请输入或选择手机号码":(!Tools.prototype.isMobileNo(o.data.gameCount)||Tools.prototype.is170MobileNo(o.data.gameCount))&&(o.errorData.phoneNoError=s.errorMsg.orderMsg.phone_no_error),o.data.showCookie=!1):"3"==e?(o.data.gameCount="",o.data.showCookie=!1,o.errorData.phoneNoError="",o.errorData.errorMsg="",o.data.mobileType="",o.data.cityin="",o.clearFaceValue()):"4"==e&&(o.errorData.phoneNoError="",o.errorData.errorMsg="")},o.clearFaceValue=function(){o.orderForm.flowValue="",o.orderForm.perValue="",e.forEach(o.faceList,function(e,a){e.id="",e.choosed=!1,e.stock=!1,e.price=""})},o.checkPhoneNo=function(e){return o.data.gameCount=o.data.gameCount.replace(/\D/g,""),o.clearError("4"),o.data.gameCount.length>11&&(o.data.gameCount=o.data.gameCount.substr(0,11)),Tools.prototype.isEmpty(o.data.gameCount)?void(o.data.showCookie=!1):(Tools.prototype.isEmpty(o.data.gameCount)||"1"!=e||(o.data.showCookie=!0),void(11==o.data.gameCount.length?(o.data.showCookie=!1,Tools.prototype.isMobileNo(o.data.gameCount)&&!Tools.prototype.is170MobileNo(o.data.gameCount)?("1"==e&&$("#gameCount").blur(),c.remove("FlowerRechargeNo"),c.put("FlowerRechargeNo",o.data.gameCount),d.getPhoneInfo(o.data.gameCount,function(e){if("success"==e.message){switch(e.data[0].prvcin==e.data[0].cityin?o.data.cityin=e.data[0].prvcin:o.data.cityin=e.data[0].prvcin+" "+e.data[0].cityin,o.data.cityin+=e.data[0].mobileType,o.data.mobileType=e.data[0].mobileType,c.remove("FlowerRechargeInfo"),c.put("FlowerRechargeInfo",o.data.cityin),c.remove("FlowerTypeInfo"),c.put("FlowerTypeInfo",o.data.mobileType),o.data.mobileType){case"移动":o.faceList=d.getFaceValueForCM;break;case"联通":o.faceList=d.getFaceValueForCU;break;case"电信":o.faceList=d.getFaceValueForCT;break;default:o.faceList=d.getFlowFaceValue}o.getFlowSalePrice()}else o.data.mobileType="",o.data.cityin=""})):(o.data.mobileType="",o.data.cityin="",o.errorData.phoneNoError=s.errorMsg.orderMsg.phone_no_error)):(Tools.prototype.isEmpty(o.data.mobileType)&&Tools.prototype.isEmpty(o.data.cityin)||(o.data.cityin="",o.data.mobileType=""),o.errorData.phoneNoError="",o.clearFaceValue())))},o.choosePhoneNo=function(e){o.data.gameCount=e,o.data.showCookie=!1,o.checkPhoneNo("2")},o.getFlowSalePrice=function(){Tools.prototype.isEmpty(o.data.mobileType)||e.forEach(o.faceList,function(e,r){d.getFlowSalePrice({gameCount:o.data.gameCount,flowValue:e.flowValue,perValue:e.perValue,code:a.code},function(r){e.choosed=!1,"success"==r.message&&0<r.data.length?(e.price=r.data[0].salePrice,e.stock=!0,Tools.prototype.isEmpty(a.faceValue)||e.perValue!=a.faceValue||o.chooseValue(e.flowValue)):(e.price="",e.stock=!1)})})},o.chooseValue=function(t){return o.data.showCookie=!1,"phonerecharge"==t?((!Tools.prototype.isMobileNo(o.data.gameCount)||Tools.prototype.is170MobileNo(o.data.gameCount))&&(o.data.gameCount=""),a.initMarketInfo(),void r.go("phonerecharge",{phoneNo:o.data.gameCount})):Tools.prototype.isEmpty(o.data.mobileType)?void 0:(t!=o.orderForm.flowValue&&a.initMarketInfo(),e.forEach(o.faceList,function(e,r){e.flowValue==t?e.stock?(e.choosed=!0,o.orderForm.flowValue=e.flowValue,o.orderForm.perValue=e.perValue,o.data.cash=e.price,a.marketInfo.faceValue=o.orderForm.perValue,a.marketInfo.getDefaultFlag=!0,"移动"==o.data.mobileType?o.category="3A":"联通"==o.data.mobileType?o.category="3B":"电信"==o.data.mobileType?o.category="3C":o.category="3",a.getDefaultMarketBill(o,o.category)):(e.choosed=!1,o.orderForm.flowValue="",o.orderForm.perValue="",o.data.cash="",a.marketInfo.faceValue=""):e.choosed=!1}),Tools.prototype.isEmpty(o.orderForm.perValue)?void(o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock):void o.clearError("4"))},o.useMarketBill=function(e){return Tools.prototype.isEmpty(a.userLoginId)?void r.go("login"):("移动"==o.data.mobileType?o.category="3A":"联通"==o.data.mobileType?o.category="3B":"电信"==o.data.mobileType?o.category="3C":o.category="3",a.marketInfo.faceValue=o.orderForm.perValue,void r.go("market",{category:o.category}))},o.setCash=function(){Tools.prototype.isEmpty(a.marketInfo.billId)||(parseFloat(a.marketInfo.cash)>=parseFloat(o.data.cash)?o.data.cash="0":o.data.cash=(1e3*parseFloat(o.data.cash)-1e3*parseFloat(a.marketInfo.cash))/1e3)},Tools.prototype.isEmpty(m)&&Tools.prototype.isEmpty(o.data.gameCount))if(Tools.prototype.isEmpty(c.get("FlowerRechargeNo")))Tools.prototype.isEmpty(a.rechargeAccount)?(o.data.cash="",o.faceList=d.getFlowFaceValue,o.clearFaceValue()):(o.data.gameCount=a.rechargeAccount,o.checkPhoneNo("2"));else{var y=c.get("FlowerRechargeNo");Tools.prototype.isEmpty(y)||(o.data.gameCount=y);var h=c.get("FlowerRechargeInfo"),f=c.get("FlowerTypeInfo");if(Tools.prototype.isEmpty(h))o.data.cash="",o.faceList=d.getFlowFaceValue,o.clearFaceValue();else{switch(o.data.cityin=h,o.data.mobileType=f,o.data.mobileType){case"移动":o.faceList=d.getFaceValueForCM;break;case"联通":o.faceList=d.getFaceValueForCU;break;case"电信":o.faceList=d.getFaceValueForCT;break;default:o.faceList=d.getFlowFaceValue}e.forEach(o.faceList,function(e,a){e.choosed&&!Tools.prototype.isEmpty(e.price)&&(o.data.cash=e.price,o.orderForm.cardId=e.id,o.orderForm.perValue=e.perValue,o.orderForm.flowValue=e.flowValue)}),Tools.prototype.isEmpty(o.data.cash)?(a.marketInfo.faceValue="",o.checkPhoneNo("2")):o.setCash()}}else a.rechargeAccount="",a.faceValue="",o.data.gameCount=m,o.checkPhoneNo("2");o.takeOrder=function(e,r){return e.target.disabled=!0,o.data.showCookie=!1,Tools.prototype.isEmpty(o.data.gameCount)?(o.errorData.phoneNoError=s.errorMsg.commonMsg.no_phone,void(e.target.disabled=!1)):!Tools.prototype.isMobileNo(o.data.gameCount)||Tools.prototype.is170MobileNo(o.data.gameCount)?(o.errorData.phoneNoError=s.errorMsg.orderMsg.phone_no_error,void(e.target.disabled=!1)):Tools.prototype.isEmpty(o.orderForm.flowValue)?(o.errorData.errorMsg=s.errorMsg.commonMsg.no_face_value,void(e.target.disabled=!1)):(a.bank=r,o.orderForm.gameCount=o.data.gameCount,o.orderForm.marketBillId=a.marketInfo.billId,void n.takeSaleOrderNew(o.orderForm,function(t){if("success"==t.message){a.saveCookies("flowNoes",o.orderForm.gameCount);var c={orderNo:t.data[0].billId,bankCode:r.bankCode,payTypeId:r.payTypeId,payType:r.payType,menu:"flowrecharge",returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/"+a.menu,code:a.code,memberId:a.userLoginId,marketBillId:o.orderForm.marketBillId};"0820"==c.bankCode&&(c.payoutName=t.data[0].cardName),l.getPayUrlForMobile(c,function(a){"success"==a.message?location.href=a.data[0]:o.errorData.errorMsg=s.errorMsg.commonMsg.pay_error,e.target.disabled=!1})}else o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock,e.target.disabled=!1}))},Tools.prototype.isEmpty(a.lastUrl)||n.takeSaleOrderNew(a.lastForm,function(e){if("success"==e.message){a.saveCookies("flowNoes",o.lastForm.gameCount);var r={orderNo:e.data[0].billId,bankCode:a.bank.bankCode,payTypeId:a.bank.payTypeId,payType:a.bank.payType,menu:"flowrecharge",returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/"+a.menu,code:a.code,memberId:a.userLoginId,marketBillId:a.lastForm.marketBillId};"0820"==r.bankCode&&(r.payoutName=e.data[0].cardName),l.getPayUrlForMobile(r,function(e){"success"==e.message?location.href=e.data[0]:o.errorData.errorMsg=s.errorMsg.commonMsg.pay_error,a.lastUrl="",a.lastForm=""})}else a.lastUrl="",a.lastForm="",o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock})}])}),define("controller/mobile/standard/category/gas-controller",["angular"],function(e){var a=e.module("openwebApp.controller.gas.gasModule",[]);a.controller("GasRechargeCtrl",["$rootScope","$scope","$ionicModal","$state","$stateParams","$compile","$cookieStore","MessageService","ProductService","OrderService","PayService","MemberService","MenuService",function(a,o,r,t,c,i,s,d,n,l,p,u,m){var g=i(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);if(!Tools.prototype.isEmpty(a.userData.header)){var y=i(e.element("<"+a.userData.header+"></"+a.userData.header+">"))(o);$("#header").html(y)}$("#copyright").html(g),a.userData.title="加油卡",a.menu="gasrecharge",a.curRouter=a.menu,a.rechargeDesc=m.gasrecharge.desc,o.data={gasCardNo:"",cno:"1",gasCardName:"",gasCardTel:"",getOilFlag:!1,cardNum:"",cash:"",isOneFaceValue:!1,gasCardIsNoUse:"",hasCookie:!1,showCookie:!1,showNumInput:!1,isSinopec:!0,isFirstInit:!0,arbitraryAmount:"",cardType:"",canCleanHistory:!0},o.cookieNos=[],o.orderForm={orderType:"GASRECHARGE",cardNum:"1",cardType:0,cardId:"",perValue:"",memberId:a.userLoginId,platform:"Mobile",code:a.code,ofLinkId:a.ofLinkId},o.payList=a.userData.payList,r.fromTemplateUrl("../../../partials/mobile/standard/common/prompt.html",{scope:o,focusFirstInput:!1}).then(function(e){o.model=e}),o.faceValueList=n.getFaceValueForGasRecharge,o.clearArbitraryAmountError=function(r){"58"==a.code&&a.initMarketInfo(),"1"==r?(o.clearError(4),$("#arbitrarycharge")[0].placeholder="",o.data.cash="",e.forEach(o.faceValueList,function(e,a){e.choosed=!1})):"2"==r&&Tools.prototype.isEmpty(o.data.arbitraryAmount)&&($("#arbitrarycharge")[0].placeholder="任意充")},o.clearFaceValue=function(){e.forEach(o.faceValueList,function(e,a){e.stock=!1,e.choosed=!1,e.price="",e.productCode=""}),o.orderForm.cardId="",
o.orderForm.perValue="",Tools.prototype.isEmpty(o.data.arbitraryAmount)||(o.data.arbitraryAmount="",$("#arbitrarycharge")[0].placeholder="任意充")},o.gasCardNoFormat=/^(100011)\d{13}$/,o.gasCardNoLength=19,o.errorData={oilNOMsg:"",errorMsg:"",agreementMsg:"",cardMsg:"",orderMsg:""},o.displayHistory=function(){Tools.prototype.isEmpty(o.cookieNos)?(o.data.hasCookie=!1,o.gasCardNos=""):(o.data.hasCookie=!0,o.gasCardNos=JSON.parse("["+o.cookieNos+"]"))},o.getHistory=function(){Tools.prototype.isEmpty(a.userLoginId)?(o.cookieNos=Tools.prototype.saveCookie("gasCardNos"),o.displayHistory()):u.getCasheUserInfo({randomId:a.userLoginId},function(e){"success"==e.message&&0<e.data.length&&(o.cookieNos=e.data[0].gasCardNos,o.data.canCleanHistory=!1,o.displayHistory())})},o.getHistory(),o.showCookie=function(){o.getHistory(),o.data.showCookie=!o.data.showCookie},o.clearCookie=function(){Tools.prototype.saveCookie("gasCardNos",null),o.data.hasCookie=!1,o.data.showCookie=!1},o.clearError=function(e){"1"==e?($("#gasCardNo")[0].placeholder="",o.data.showCookie=!1):"2"==e?(Tools.prototype.isEmpty(o.data.gasCardNo)&&($("#gasCardNo")[0].placeholder="请输入加油卡"),o.data.showCookie=!1):"3"==e?(o.data.gasCardNo="",o.data.showCookie=!1,o.errorData.oilNOMsg="",o.errorData.errorMsg="",o.data.gasCardName="",o.errorData.agreementMsg="",o.errorData.orderMsg="",o.errorData.cardMsg="",o.clearFaceValue()):"4"==e&&(o.errorData.oilNOMsg="",o.errorData.errorMsg="",o.errorData.agreementMsg="",o.errorData.orderMsg="",o.errorData.cardMsg="")},o.chooseGasCardNo=function(e){o.data.gasCardNo=e,o.data.showCookie=!1,o.checkOilNO("1")},o.gasCardNoFormat=/^(100011)\d{13}$/,o.gasCardNoLength=19,o.checkOilNO=function(e){if(o.clearError(4),o.data.gasCardName="","1"==e){if(o.errorData.oilNOMsg="",o.errorData.errorMsg="",o.errorData.agreementMsg="",o.errorData.orderMsg="",o.errorData.cardMsg="",o.data.gasCardNo=o.data.gasCardNo.replace(/\D/g,""),Tools.prototype.isEmpty(o.data.gasCardNo))return!1;if(o.initFormat(o.data.gasCardNo),o.data.gasCardNo.length>o.gasCardNoLength&&(o.data.gasCardNo=o.data.gasCardNo.substr(0,o.gasCardNoLength)),o.data.gasCardNo.length==o.gasCardNoLength)return $("#gasCardNo").blur(),o.clearFaceValue(),o.gasCardNoFormat.test(o.data.gasCardNo)?(o.errorData.oilNOMsg="",o.data.isFirstInit=!1,!0):(o.errorData.oilNOMsg=d.errorMsg.commonMsg.oilNO_format_error,!1)}else{if("2"==e)return Tools.prototype.isEmpty(o.data.gasCardNo)?!1:(o.initFormat(o.data.gasCardNo),o.gasCardNoFormat.test(o.data.gasCardNo)?(o.errorData.oilNOMsg="",o.searchOil(),!0):(o.errorData.oilNOMsg=d.errorMsg.commonMsg.oilNO_format_error,!1));if("3"==e)return Tools.prototype.isEmpty(o.data.gasCardNo)?!1:(o.initFormat(o.data.gasCardNo),o.gasCardNoFormat.test(o.data.gasCardNo)?(o.errorData.oilNOMsg="",!0):(o.errorData.oilNOMsg=d.errorMsg.commonMsg.oilNO_format_error,!1))}},o.checkHistoryNoList=function(e){if(o.gasCardNos&&o.gasCardNos.length>0)for(var a=0;a<o.gasCardNos.length;a++)if(o.gasCardNos[a].gasCardNo==e)return!1;if(o.gasCardNos&&o.gasCardNos.length>=5){o.gasCardNos.splice(4,o.gasCardNos.length),o.cookieNos="";for(var a=0;a<o.gasCardNos.length;a++){var r={gasCardNo:o.gasCardNos[a].gasCardNo,gasCardName:o.gasCardNos[a].gasCardName};3==a?o.cookieNos+=JSON.stringify(r):o.cookieNos+=JSON.stringify(r)+","}}return!0},o.initFormat=function(e){"1"==e.slice(0,1)?(o.gasCardNoFormat=/^(100011)\d{13}$/,o.gasCardNoLength=19):(o.gasCardNoFormat=/^(9)\d{15}$/,o.gasCardNoLength=16)},o.cancle=function(){o.model.hide(),o.clearFaceValue(),o.data.isFirstInit=!0},o.confirm=function(){o.model.hide(),"1"==o.data.gasCardNo.slice(0,1)?o.getFaceValueList("1"):o.getFaceValueList("2")},o.searchOil=function(){return Tools.prototype.isEmpty(o.data.gasCardNo)?(o.errorData.oilNOMsg=d.errorMsg.commonMsg.no_oilNo,!1):(o.data.getOilFlag=!0,o.data.oilNO=o.data.gasCardNo,s.remove("gasRechargeNo"),s.put("gasRechargeNo",o.data.gasCardNo),"1"==o.data.oilNO.slice(0,1)?o.data.cno="1":o.data.cno="2",n.getGasCardInfo(o.data,function(e){if(o.data.getOilFlag=!1,"success"==e.message&&0<e.data.length){o.errorData.errorMsg="";var a=e.data[0].peUserName.split(";");return 1<a.length?("0"==a[0]?("1"==o.data.gasCardNo.slice(0,1)?o.data.gasCardName="中石化 ":o.data.gasCardName="中石油 ",o.data.gasCardName+=a[1]):o.data.gasCardName="","1"==a[0]?o.data.gasCardIsNoUse=a[1]:o.data.gasCardIsNoUse="","1"==a[0]?(o.model.show(),!1):("1"==o.data.gasCardNo.slice(0,1)?o.getFaceValueList("1"):o.getFaceValueList("2"),s.remove("gasRechargeInfo"),s.put("gasRechargeInfo",o.data.gasCardName),!0)):(o.model.show(),!1)}return o.model.show(),!1}),!1)},o.getFaceValueList=function(r){n.getGasCardProductInfo(r,function(t){o.data.isFirstInit=!1,"success"==t.message&&0<t.data.length?e.forEach(o.faceValueList,function(c,i){e.forEach(t.data,function(e,a){"2"==r?"1"==c.faceValue&&"1"==e.faceValue&&(c.productCode=e.productCode):c.faceValue==e.faceValue&&(c.productCode=e.productCode)}),c.stock=!1,c.choosed=!1,"2"==r&&"1"!=c.faceValue&&(c.productCode=""),Tools.prototype.isEmpty(c.productCode)?c.price="缺货":n.checkCanOrder({cardId:c.productCode,code:a.code},function(e){"success"==e.message?(n.getSalePrice({cardId:c.productCode,code:a.code},function(e){"success"==e.message?(c.price="售价"+1e3*e.data[0].salePrice/1e3+"元",c.salePrice=1e3*e.data[0].salePrice/1e3,c.isOneFaceValue&&(o.data.price=1e3*e.data[0].salePrice/1e3)):(c.salePrice="",c.price="缺货")}),c.stock=!0):c.price="缺货"})}):e.forEach(o.faceValueList,function(e,a){e.stock=!1,e.choosed=!1,e.price="缺货"})})},o.chooseValue=function(r){o.clearError(),o.orderForm.cardNum="1",Tools.prototype.isEmpty(o.data.arbitraryAmount)||(o.data.arbitraryAmount="",$("#arbitrarycharge")[0].placeholder="任意充"),r.productCode!=o.orderForm.cardId&&a.initMarketInfo(),e.forEach(o.faceValueList,function(e,t){e.productCode==r.productCode?e.stock?(o.faceValueList[t].choosed=!0,o.orderForm.cardId=e.productCode,o.orderForm.perValue=e.faceValue,o.data.cash=e.salePrice,a.marketInfo.faceValue=o.orderForm.perValue,a.marketInfo.getDefaultFlag=!0,a.getDefaultMarketBill(o,"5")):(o.faceValueList[t].choosed=!1,o.orderForm.cardId="",o.orderForm.perValue="",o.data.cash="",a.marketInfo.faceValue=""):o.faceValueList[t].choosed=!1}),o.clearError("4")},o.checkArbitraryAmount=function(r){if(e.forEach(o.faceValueList,function(e,a){o.orderForm.cardId="",o.orderForm.perValue="",o.data.cash="",o.faceValueList[a].choosed=!1}),3==r&&(Tools.prototype.isEmpty(o.data.arbitraryAmount)&&(o.errorData.errorMsg=d.errorMsg.commonMsg.no_charge_amount),r=2),"1"==r){if(o.errorData.errorMsg==d.errorMsg.commonMsg.wrong_charge_amount&&(o.errorData.errorMsg=""),o.data.arbitraryAmount=o.data.arbitraryAmount.replace(/\D/g,""),Tools.prototype.isEmpty(o.data.arbitraryAmount))return o.data.cash="",!1;var t=parseInt(o.data.arbitraryAmount),c=!1;return t>=1&&5e3>=t&&(c=!0),c?(e.forEach(o.faceValueList,function(e,a){e.isOneFaceValue?(o.faceValueList[a].choosed=!0,o.orderForm.cardId=e.productCode,o.orderForm.perValue=e.faceValue,Tools.prototype.isEmpty(o.data.price)&&!Tools.prototype.isEmpty(e.salePrice)&&(o.data.price=e.salePrice),e.cardNum=o.data.arbitraryAmount):o.faceValueList[a].choosed=!1}),o.orderForm.cardNum=o.data.arbitraryAmount,o.data.total="售价"+parseFloat((1e3*o.data.price*o.data.arbitraryAmount/1e3).toFixed(3))+"元",o.data.cash=parseFloat((1e3*o.data.price*o.data.arbitraryAmount/1e3).toFixed(3)),a.marketInfo.faceValue=o.orderForm.cardNum,a.marketInfo.getDefaultFlag=!0,"58"==a.code?a.initMarketInfo():a.getDefaultMarketBill(o,"5")):o.errorData.errorMsg=d.errorMsg.commonMsg.wrong_charge_amount,c}if("2"==r){if(!Tools.prototype.isEmpty(o.errorData.errorMsg)&&o.errorData.errorMsg!=d.errorMsg.commonMsg.wrong_charge_amount)return!1;o.checkArbitraryAmount("1")&&(o.errorData.errorMsg="")}},o.useMarketBill=function(e){return a.marketInfo.faceValue=o.orderForm.perValue,Tools.prototype.isEmpty(a.userLoginId)?void t.go("login"):void t.go("market",{category:e})},o.setCash=function(){Tools.prototype.isEmpty(a.marketInfo.billId)||(parseFloat(a.marketInfo.cash)>=parseFloat(o.data.cash)?o.data.cash="0":o.data.cash=(1e3*parseFloat(o.data.cash)-1e3*parseFloat(a.marketInfo.cash))/1e3)};var h=s.get("gasRechargeNo");Tools.prototype.isEmpty(h)||(o.data.gasCardNo=h);var f=s.get("gasRechargeInfo");Tools.prototype.isEmpty(f)||(o.data.gasCardName=f),e.forEach(o.faceValueList,function(e,a){e.stock&&e.choosed&&!Tools.prototype.isEmpty(e.salePrice)&&(o.data.isFirstInit=!1,o.data.cash=e.salePrice,o.orderForm.cardId=e.productCode,o.orderForm.perValue=e.faceValue,e.isOneFaceValue&&(o.orderForm.cardNum=e.cardNum,o.data.arbitraryAmount=e.cardNum,o.data.total="售价"+parseFloat((1e3*e.salePrice*o.data.arbitraryAmount/1e3).toFixed(3))+"元",o.data.cash=parseFloat((1e3*e.salePrice*o.data.arbitraryAmount/1e3).toFixed(3))))}),Tools.prototype.isEmpty(o.data.cash)?(o.data.cash="",o.data.isFirstInit=!0,a.marketInfo.faceValue="",o.clearFaceValue(),o.checkOilNO("2")):o.setCash(),o.takeOrder=function(e,r){return e.target.disabled=!0,o.data.showCookie=!1,a.lastUrl&&!Tools.prototype.isEmpty(a.lastUrl)?o.orderForm=a.lastForm:o.orderForm.gameCount=o.data.gasCardNo,$("#agreement")[0].checked?Tools.prototype.isEmpty(o.errorData.oilNOMsg)&&Tools.prototype.isEmpty(o.errorData.errorMsg)&&o.checkOilNO(3)?Tools.prototype.isEmpty(o.orderForm.cardId)?(o.errorData.cardMsg=d.errorMsg.commonMsg.no_face_value,void(e.target.disabled=!1)):"副卡不能进行充值"==o.data.gasCardIsNoUse?(o.errorData.oilNOMsg=o.data.gasCardIsNoUse,void(e.target.disabled=!1)):(a.bank=r,o.orderForm.marketBillId=a.marketInfo.billId,void l.takeSaleOrder(o.orderForm,function(t){if("success"==t.message){o.bindUserGasCard(o.data.gasCardNo),o.orderForm.gameCount="",o.orderForm.cardId="";var c={orderNo:t.data[0].billId,bankCode:r.bankCode,payTypeId:r.payTypeId,payType:r.payType,returnUrl:a.userData.returnUrl+a.code+"/"+a.menu,code:a.code,memberId:a.userLoginId,marketBillId:o.orderForm.marketBillId};"0820"==c.bankCode&&(c.payoutName=t.data[0].cardName),p.getPayUrlForMobile(c,function(a){"success"==a.message?location.href=a.data[0]:o.errorData.errorMsg=d.errorMsg.commonMsg.pay_error,e.target.disabled=!1})}else o.errorData.orderMsg=d.errorMsg.commonMsg.no_stock,e.target.disabled=!1})):void(e.target.disabled=!1):(o.errorData.agreementMsg=d.errorMsg.commonMsg.prompt_agreetment_check,void(e.target.disabled=!1))},Tools.prototype.isEmpty(a.lastUrl)||l.takeSaleOrder(a.lastForm,function(e){if(a.lastUrl="","success"==e.message){o.bindUserGasCard(a.lastForm.gasCardNo),o.orderForm.gameCount="",o.orderForm.cardId="";var r={orderNo:e.data[0].billId,bankCode:a.bank.bankCode,payTypeId:a.bank.payTypeId,payType:a.bank.payType,returnUrl:a.userData.returnUrl+a.code+"/"+a.menu,code:a.code,memberId:a.userLoginId,marketBillId:a.lastForm.marketBillId};"0820"==r.bankCode&&(r.payoutName=e.data[0].cardName),p.getPayUrlForMobile(r,function(e){"success"==e.message?location.href=e.data[0]:o.errorData.errorMsg=d.errorMsg.commonMsg.pay_error,a.lastUrl="",a.lastForm=""})}else a.lastUrl="",a.lastForm="",o.errorData.orderMsg=d.errorMsg.commonMsg.no_stock}),o.bindUserGasCard=function(e){if(o.checkHistoryNoList(o.data.gasCardNo)){var r={gasCardNo:o.data.gasCardNo,gasCardName:o.data.gasCardName};Tools.prototype.isEmpty(o.gasCardNos)||0==o.gasCardNos.length?o.cookieNos=JSON.stringify(r):o.cookieNos=JSON.stringify(r)+","+o.cookieNos,Tools.prototype.isEmpty(a.userLoginId)?Tools.prototype.saveCookie("gasCardNos",o.cookieNos,{expires:30}):u.updateUserInfo({gasCardNos:o.cookieNos,randomId:a.userLoginId},function(e){})}}}])}),define("controller/mobile/standard/category/game-controller",["angular"],function(e){var a=e.module("openwebApp.controller.game.gameModule",[]);a.controller("GameIndexCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","MessageService","ProductService","MenuService",function(a,o,r,t,c,i,s,d,n){var l=c(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);$("#copyright").html(l),a.menu="gamerecharge",a.userData.title="游戏",a.curRouter=a.menu,a.rechargeDesc=n.gamerecharge.desc}]),a.controller("GameListCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","MessageService","ProductService","MenuService",function(e,a,o,r,t,c,i,s,d){e.menu="gamerecharge",e.userData.title="游戏",e.curRouter=e.menu,e.rechargeDesc=d.gamerecharge.desc,a.letters=s.getLettersList,a.data={search:""},s.getGameList(function(e){"success"==e.message?a.gameList=e.data:a.gameList=""});var n=Tools.prototype.saveCookie("gameList");Tools.prototype.isEmpty(n)?a.rechargeGameList="":a.rechargeGameList=n.split(";"),a.clearSearch=function(e){"1"==e?$("#search")[0].placeholder="":"2"==e?Tools.prototype.isEmpty(a.data.search)&&($("#search")[0].placeholder="请输入游戏名称检索"):"3"==e&&(a.data.search="",$("#search")[0].placeholder="请输入游戏名称检索")},a.goCharge=function(e){o.go("gamecharge",{gamename:e})}}]),a.controller("GameRechargeCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","$ionicModal","MessageService","ProductService","OrderService","PayService","MenuService",function(a,o,r,t,c,i,s,d,n,l,p,u){var m=c(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);if($("#copyright").html(m),a.menu="gamecharge",a.userData.title="游戏",a.curRouter=a.menu,a.rechargeDesc=u.gamerecharge.desc,o.data={gameName:t.gamename,isBattleAccount:"魔兽世界"==t.gamename?!0:!1,chooseBattleAccount:!1,battleAccount:"",gameCount:"",arbitraryNum:"",isArbitrary:!1,cardNum:"",purNum:"",salePrice:"",cash:"",hasGCCookie:!1,showGCCookie:!1,hasBCCookie:!1,showBCCookie:!1},o.gameAreas="",o.gameServices="",o.orderForm={orderType:"GAMERECHARGE",gameCount:"",battleAccount:"",cardNum:"",cardType:0,cardId:"",gameArea:"",gameServer:"",perValue:"",memberId:a.userLoginId,platform:"Mobile",code:a.code,ofLinkId:a.ofLinkId},o.errorData={errorMsg:""},o.gameInfo="",Tools.prototype.isEmpty(o.data.gameName)){if(o.gameInfo=n.chargeGameInfo,o.data.isBattleAccount="魔兽世界"==o.gameInfo.name?!0:!1,Tools.prototype.isEmpty(o.gameInfo.name))return void r.go("gamerecharge")}else n.getGameInfo({code:a.code,productName:o.data.gameName},function(e){return"success"!=e.message?(o.gameInfo="",void r.go("gamerecharge")):(n.chargeGameInfo.name=e.data[0].name,n.chargeGameInfo.icon=e.data[0].icon,n.chargeGameInfo.faceValueList=e.data[0].faceValueList,o.gameInfo=n.chargeGameInfo,void 0)});var g=Tools.prototype.saveCookie("gameNoes");Tools.prototype.isEmpty(g)?(o.data.hasGCCookie=!1,o.gameNoes=""):(o.data.hasGCCookie=!0,o.gameNoes=g.split(";")),o.showGCCookie=function(){o.data.showGCCookie=!o.data.showGCCookie},o.clearGCCookie=function(){Tools.prototype.saveCookie("gameNoes",null),o.gameNoes="",o.data.hasGCCookie=!1,o.data.showGCCookie=!1};var y=Tools.prototype.saveCookie("battleNoes");Tools.prototype.isEmpty(y)?(o.data.hasBCCookie=!1,o.battleNoes=""):(o.data.hasBCCookie=!0,o.battleNoes=y.split(";")),o.showBCCookie=function(){o.data.showBCCookie=!o.data.showBCCookie},o.clearBCCookie=function(){Tools.prototype.saveCookie("battleNoes",null),o.battleNoes="",o.data.hasBCCookie=!1,o.data.showBCCookie=!1},o.clearError=function(e){"1"==e?o.errorData.errorMsg="":"2"==e?(o.data.gameCount="",o.data.showGCCookie=!1):"3"==e&&(o.data.battleAccount="",o.data.showBCCookie=!1)},o.clearFaceValue=function(a){Tools.prototype.isEmpty(o.gameInfo)||(e.forEach(o.gameInfo.faceValueList,function(e,a){e.choosed=!1}),"1"==a&&(o.orderForm.cardId="",o.orderForm.perValue="",Tools.prototype.isEmpty(o.data.arbitraryNum)||(o.data.arbitraryNum="",$("#arbitrarycharge")[0].placeholder="任意充")))},o.chooseValue=function(r){o.clearError("1"),o.data.isArbitrary=!1,Tools.prototype.isEmpty(o.data.arbitraryNum)||(o.data.arbitraryNum="",$("#arbitrarycharge")[0].placeholder="任意充"),r.cardId!=o.orderForm.cardId&&a.initMarketInfo(),e.forEach(o.gameInfo.faceValueList,function(e,a){r.cardId==e.cardId?(e.stock?(e.choosed=!0,o.orderForm.cardId=e.cardId,o.orderForm.perValue=e.faceValue,o.data.salePrice=e.salePrice,o.data.purNum=e.buyNum,o.data.cardNum=""):(e.choosed=!1,o.orderForm.cardId="",o.orderForm.perValue="",o.data.salePrice="",o.data.purNum="",o.data.cardNum=""),o.getGameAreas(o.orderForm.cardId)):e.choosed=!1}),o.data.cash=""},o.checkCardNum=function(e){"1"==e?o.data.cardNum=o.data.cardNum.replace(/\D/g,""):"2"==e?!Tools.prototype.isEmpty(o.data.cardNum)&&parseInt(o.data.cardNum)>1?o.data.cardNum=parseInt(o.data.cardNum)-1+"":o.data.cardNum="1":"3"==e&&(Tools.prototype.isEmpty(o.data.cardNum)?o.data.cardNum="1":o.data.cardNum=parseInt(o.data.cardNum)+1+""),o.checkCardNumLimit(o.data.cardNum)?(o.errorData.errorMsg="",o.getCash()):(o.errorData.errorMsg=d.errorMsg.commonMsg.card_num_error,o.data.cash="")},o.checkCardNumLimit=function(e){if(Tools.prototype.isEmpty(e))return!1;var a=parseInt(e);if(Tools.prototype.isEmpty(o.data.purNum))return!1;for(var r,t=!1,c=o.data.purNum.split(","),s=0;s<c.length;s++)if(-1!=c[s].indexOf("-")){if(r=c[s].split("-"),a>=parseInt(r[0])&&a<=parseInt(r[1])){t=!0;break}}else if(parseInt(c[s])==a){t=!0;break}return t&&(i.remove("GameCardNum"),i.put("GameCardNum",e)),t},o.clearArbitraryAmountError=function(a){"1"==a?(o.clearError("1"),Tools.prototype.isEmpty($("#arbitrarycharge")[0])||($("#arbitrarycharge")[0].placeholder=""),o.clearFaceValue("2"),o.data.isArbitrary=!0,e.forEach(o.gameInfo.faceValueList,function(e,a){e.arbitrary?(e.stock?(e.choosed=!0,o.orderForm.cardId=e.cardId,o.orderForm.perValue=e.faceValue,o.data.salePrice=e.salePrice,o.data.purNum=e.buyNum,o.data.cardNum=""):(e.choosed=!1,o.orderForm.cardId="",o.orderForm.perValue="",o.data.salePrice="",o.data.purNum="",o.data.cardNum="",o.data.arbitraryNum=""),o.getGameAreas(o.orderForm.cardId)):e.choosed=!1})):"2"==a&&Tools.prototype.isEmpty(o.data.arbitraryNum)&&($("#arbitrarycharge")[0].placeholder="任意充")},o.checkArbitraryAmount=function(e){return Tools.prototype.isEmpty(o.orderForm.cardId)?void(o.data.arbitraryNum=""):(o.data.arbitraryNum=o.data.arbitraryNum.replace(/\D/g,""),void(o.checkCardNumLimit(o.data.arbitraryNum)?(o.errorData.errorMsg="",o.getCash()):(o.errorData.errorMsg=d.errorMsg.commonMsg.card_num_error,o.data.cash="")))},o.checkGameCount=function(e){"1"==e?$("#gameCount")[0].placeholder="":"2"==e?(Tools.prototype.isEmpty(o.data.gameCount)?$("#gameCount")[0].placeholder="请输入游戏账号":(i.remove("GameRechargeNo"),i.put("GameRechargeNo",o.data.gameCount)),o.data.showGCCookie=!1):"3"==e?$("#battleAccount")[0].placeholder="":"4"==e?(o.errorData.errorMsg="",Tools.prototype.isEmpty(o.data.battleAccount)?$("#battleAccount")[0].placeholder="请输入通行证账号":o.checkBattleCount()?(i.remove("GameBattleRechargeNo"),i.put("GameBattleRechargeNo",o.data.battleAccount)):o.errorData.errorMsg=d.errorMsg.commonMsg.battle_account_format_error,o.data.showBCCookie=!1):"5"==e?$("#gameAccount")[0].placeholder="":"6"==e?(Tools.prototype.isEmpty(o.data.gameCount)?$("#gameAccount")[0].placeholder="请输入需要充值的游戏账号":(i.remove("GameRechargeNo"),i.put("GameRechargeNo",o.data.gameCount)),o.data.showGCCookie=!1):"7"==e?Tools.prototype.isEmpty(o.data.gameCount)?o.data.showGCCookie=!1:o.data.showGCCookie=!0:"8"==e&&(Tools.prototype.isEmpty(o.data.battleAccount)?o.data.showBCCookie=!1:o.data.showBCCookie=!0)},o.chooseGCNo=function(e){o.data.gameCount=e,o.data.showGCCookie=!1,i.remove("GameRechargeNo"),i.put("GameRechargeNo",o.data.gameCount)},o.chooseBCNo=function(e){o.data.battleAccount=e,o.data.showBCCookie=!1,i.remove("GameBattleRechargeNo"),i.put("GameBattleRechargeNo",o.data.battleAccount)},o.checkBattleCount=function(){return!/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/.test(o.data.battleAccount)||50<o.data.battleAccount.length?!1:!0},o.makeOnlyAccount=function(){o.data.chooseBattleAccount=!o.data.chooseBattleAccount},s.fromTemplateUrl("../../../partials/mobile/standard/game/game-area.html",{scope:o,focusFirstInput:!1}).then(function(e){o.gameAreaModel=e}),s.fromTemplateUrl("../../../partials/mobile/standard/game/game-service.html",{scope:o,focusFirstInput:!1}).then(function(e){o.gameServiceModel=e}),o.$on("$destroy",function(){o.gameAreaModel.remove(),o.gameServiceModel.remove()}),o.getGameAreas=function(e){Tools.prototype.isEmpty(e)?o.gameAreas="":n.getGameArea({cardId:e},function(e){"success"==e.message?o.gameAreas=e.data:o.gameAreas=""})},o.getGameServices=function(e,a){Tools.prototype.isEmpty(e)||Tools.prototype.isEmpty(a)?o.gameServices="":n.getGameServer({cardId:e,gameArea:a},function(e){"success"==e.message?o.gameServices=e.data:o.gameServices=""})},o.showGameAreaService=function(e){"1"==e?""!=o.gameAreas&&o.gameAreaModel.show():"2"==e&&""!=o.gameServices&&o.gameServiceModel.show()},o.chooseGameArea=function(e){o.gameAreaModel.hide(),Tools.prototype.isEmpty(e)||(o.orderForm.gameArea=e,o.getGameServices(o.orderForm.cardId,e),o.orderForm.gameServer="",i.remove("GameArea"),i.put("GameArea",o.orderForm.gameArea))},o.chooseGameService=function(e){o.gameServiceModel.hide(),Tools.prototype.isEmpty(e)||(o.orderForm.gameServer=e,i.remove("GameServer"),i.put("GameServer",o.orderForm.gameServer))},o.useMarketBill=function(e){return Tools.prototype.isEmpty(o.orderForm.perValue)||Tools.prototype.isEmpty(o.data.cardNum)?a.marketInfo.faceValue=o.orderForm.perValue:a.marketInfo.faceValue=parseInt(o.orderForm.perValue)*parseInt(o.data.cardNum),Tools.prototype.isEmpty(a.userLoginId)?void r.go("login"):void r.go("market",{category:e})},o.getCash=function(){Tools.prototype.isEmpty(o.data.arbitraryNum)||(o.data.cardNum=o.data.arbitraryNum),!Tools.prototype.isEmpty(o.data.cardNum)&&parseInt(o.data.cardNum)>0?(o.data.cash=1e3*parseFloat(o.data.salePrice)*parseInt(o.data.cardNum)/1e3,a.marketInfo.faceValue=parseInt(o.orderForm.perValue)*parseInt(o.data.cardNum),a.marketInfo.getDefaultFlag=!0,a.getDefaultMarketBill(o,"2")):(o.data.cash="",a.initMarketInfo())},o.setCash=function(){Tools.prototype.isEmpty(a.marketInfo.billId)||(parseFloat(a.marketInfo.cash)>=parseFloat(o.data.cash)?o.data.cash="0":o.data.cash=(1e3*parseFloat(o.data.cash)-1e3*parseFloat(a.marketInfo.cash))/1e3)},o.init=function(){Tools.prototype.isEmpty(o.gameInfo.faceValueList)||(e.forEach(o.gameInfo.faceValueList,function(e,a){e.choosed&&e.stock&&(e.arbitrary?(o.data.isArbitrary=!0,o.clearArbitraryAmountError("1")):(o.data.isArbitrary=!1,o.chooseValue(e)),Tools.prototype.isEmpty(i.get("GameCardNum"))||(o.data.cardNum=i.get("GameCardNum"),e.arbitrary&&(o.data.arbitraryNum=o.data.cardNum)),o.getCash())}),Tools.prototype.isEmpty(i.get("GameRechargeNo"))||(o.data.gameCount=i.get("GameRechargeNo")),!Tools.prototype.isEmpty(i.get("GameBattleRechargeNo"))&&o.data.isBattleAccount&&(o.data.battleAccount=i.get("GameBattleRechargeNo")),o.data.isBattleAccount&&Tools.prototype.isEmpty(o.data.gameCount)&&(o.data.chooseBattleAccount=!0),Tools.prototype.isEmpty(i.get("GameArea"))||(o.orderForm.gameArea=i.get("GameArea"),o.getGameServices(o.orderForm.cardId,o.orderForm.gameArea)),Tools.prototype.isEmpty(i.get("GameServer"))||(o.orderForm.gameServer=i.get("GameServer"))),i.remove("GameCardNum"),i.remove("GameRechargeNo"),i.remove("GameBattleRechargeNo"),i.remove("GameArea"),i.remove("GameServer")},o.init(),o.takeOrder=function(e,r){if(e.target.disabled=!0,Tools.prototype.isEmpty(o.orderForm.cardId))return o.errorData.errorMsg=d.errorMsg.commonMsg.no_face_value,void(e.target.disabled=!1);if(Tools.prototype.isEmpty(o.data.arbitraryNum)||(o.data.cardNum=o.data.arbitraryNum),o.orderForm.cardNum=o.data.cardNum,Tools.prototype.isEmpty(o.orderForm.cardNum))return o.errorData.errorMsg=d.errorMsg.commonMsg.no_card_num,void(e.target.disabled=!1);if(!o.checkCardNumLimit(o.orderForm.cardNum))return o.errorData.errorMsg=d.errorMsg.commonMsg.card_num_error,void(e.target.disabled=!1);if(o.data.isBattleAccount){if(Tools.prototype.isEmpty(o.data.battleAccount))return o.errorData.errorMsg=d.errorMsg.commonMsg.no_battle_account,void(e.target.disabled=!1);if(!o.checkBattleCount())return o.errorData.errorMsg=d.errorMsg.commonMsg.battle_account_format_error,void(e.target.disabled=!1);if(!o.data.chooseBattleAccount&&Tools.prototype.isEmpty(o.data.gameCount))return o.errorData.errorMsg=d.errorMsg.commonMsg.no_game_account,void(e.target.disabled=!1)}else if(Tools.prototype.isEmpty(o.data.gameCount))return o.errorData.errorMsg=d.errorMsg.commonMsg.no_game_account,void(e.target.disabled=!1);return!Tools.prototype.isEmpty(o.gameAreas)&&Tools.prototype.isEmpty(o.orderForm.gameArea)?(o.errorData.errorMsg=d.errorMsg.commonMsg.no_game_area,void(e.target.disabled=!1)):!Tools.prototype.isEmpty(o.gameServices)&&Tools.prototype.isEmpty(o.orderForm.gameServer)?(o.errorData.errorMsg=d.errorMsg.commonMsg.no_game_service,void(e.target.disabled=!1)):(o.orderForm.gameCount=o.data.gameCount,o.orderForm.battleAccount=o.data.battleAccount,o.orderForm.marketBillId=a.marketInfo.billId,a.bank=r,void l.takeSaleOrder(o.orderForm,function(t){if("success"==t.message){a.saveCookies("gameNoes",o.orderForm.gameCount),a.saveCookies("battleNoes",o.orderForm.battleAccount);var c={orderNo:t.data[0].billId,bankCode:r.bankCode,payTypeId:r.payTypeId,payType:r.payType,returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/gamerecharge",code:a.code,memberId:a.userLoginId,marketBillId:o.orderForm.marketBillId};"0820"==c.bankCode&&(c.payoutName=t.data[0].cardName),p.getPayUrlForMobile(c,function(a){"success"==a.message?location.href=a.data[0]:o.errorData.errorMsg=d.errorMsg.commonMsg.pay_error,e.target.disabled=!1})}else o.errorData.errorMsg=d.errorMsg.commonMsg.no_stock,e.target.disabled=!1}))},Tools.prototype.isEmpty(a.lastUrl)||l.takeSaleOrder(a.lastForm,function(e){if("success"==e.message){a.saveCookies("gameNoes",o.lastForm.gameCount),a.saveCookies("battleNoes",o.lastForm.battleAccount);var r={orderNo:e.data[0].billId,bankCode:a.bank.bankCode,payTypeId:a.bank.payTypeId,payType:a.bank.payType,returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/gamerecharge",code:a.code,memberId:a.userLoginId,marketBillId:a.lastForm.marketBillId};"0820"==r.bankCode&&(r.payoutName=e.data[0].cardName),p.getPayUrlForMobile(r,function(e){"success"==e.message?location.href=e.data[0]:o.errorData.errorMsg=d.errorMsg.commonMsg.pay_error,a.lastUrl="",a.lastForm=""})}else a.lastUrl="",a.lastForm="",o.errorData.errorMsg=d.errorMsg.commonMsg.no_stock})}])}),define("controller/mobile/standard/category/giftCard-controller",["angular"],function(e){var a=e.module("openwebApp.controller.giftCard.giftCardModule",[]);a.controller("GiftCardIndexCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","MessageService","ProductService","MenuService",function(a,o,r,t,c,i,s,d,n){var l=c(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);$("#copyright").html(l),a.menu="giftCardrecharge",a.userData.title="礼品卡",a.curRouter=a.menu,a.rechargeDesc=n.giftCardrecharge.desc}]),a.controller("GiftCardListCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","MessageService","ProductService","MenuService",function(e,a,o,r,t,c,i,s,d){e.menu="giftCardrecharge",e.userData.title="礼品卡",e.curRouter=e.menu,e.rechargeDesc=d.giftCardrecharge.desc,a.data={search:""},s.getGiftCardList(function(e){"success"==e.message?a.giftCardList=e.data:a.giftCardList=""}),Tools.prototype.saveCookie("giftCardList","天猫超市;唯品会");var n=Tools.prototype.saveCookie("giftCardList");Tools.prototype.isEmpty(n)?a.rechargeGiftCardList="":a.rechargeGiftCardList=n.split(";"),a.clearSearch=function(e){"1"==e?$("#search")[0].placeholder="":"2"==e?Tools.prototype.isEmpty(a.data.search)&&($("#search")[0].placeholder="请输入礼品卡名称检索"):"3"==e&&(a.data.search="",$("#search")[0].placeholder="请输入礼品卡名称检索")},a.goCharge=function(e){o.go("giftCardcharge",{giftCardName:e})}}]),a.controller("GiftCardRechargeCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","MessageService","ProductService","OrderService","PayService","MenuService",function(a,o,r,t,c,i,s,d,n,l,p){var u=c(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);$("#copyright").html(u),a.menu="giftCardcharge",a.userData.title="礼品卡",a.curRouter=a.menu,a.rechargeDesc=p.giftCardrecharge.desc;t.telPho;o.data={giftCardName:t.giftCardName,arbitraryNum:"",cardNum:"1",salePrice:"",cash:"",cityin:"",mobileType:"",hasCookie:!1,showCookie:!1,cookieData:"",telPho:"",imgUrl:""},o.payList=a.userData.payList,o.orderForm={orderType:"CARDPASSRECHARGE",cardNum:"",cardType:0,cardId:"",perValue:"",memberId:a.userLoginId,platform:"Mobile",code:a.code,telPho:"",ofLinkId:a.ofLinkId},o.errorData={phoneNoError:"",errorMsg:""};var m=Tools.prototype.saveCookie("giftCardNoes");if(Tools.prototype.isEmpty(m)?(o.data.hasCookie=!1,o.giftCardNoes=""):(o.data.hasCookie=!0,o.giftCardNoes=m.split(";")),o.showCookie=function(){o.data.showCookie=!o.data.showCookie},o.imgMatch=function(e){return Tools.prototype.isEmpty(e)?void r.go("giftCardrecharge"):e.indexOf("京东")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/card-jd.png"):e.indexOf("天猫")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/card-tm.png"):e.indexOf("当当")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/card-dd.png"):e.indexOf("国美")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/card-gm.png"):e.indexOf("唯品会")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/card-wph.png"):e.indexOf("携程")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/card-xc.png"):e.indexOf("1号店")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/card-yhd.png"):e.indexOf("亚马逊")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/card-ymx.png"):e.indexOf("中粮")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/card-zl.png"):e.indexOf("苏宁")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/card-sn.png"):void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/card-gift.png")},o.giftCardInfo="",Tools.prototype.isEmpty(o.data.giftCardName)){if(o.giftCardInfo=d.chargeGiftCardInfo,Tools.prototype.isEmpty(o.giftCardInfo.name))return void r.go("giftCardrecharge");o.data.giftCardName=o.giftCardInfo.name}else d.getGiftCardInfo({code:a.code,productName:o.data.giftCardName},function(t){if("success"!=t.message)return o.giftCardInfo="",void r.go("giftCardrecharge");var c=[];e.forEach(t.data,function(e){var a={};a.name=e.productName,a.value=e.faceValue,a.productCode=e.productCode,c.push(a)}),d.chargeGiftCardInfo.faceValueList=c,o.giftCardInfo=d.chargeGiftCardInfo,o.giftCardInfo.name=o.data.giftCardName,e.forEach(o.giftCardInfo.faceValueList,function(e,r){Tools.prototype.isEmpty(e.productCode)?(e.stock=!1,e.salePrice=""):d.checkCanOrder({cardId:e.productCode,code:a.code},function(r){"success"==r.message?d.getSalePrice({cardId:e.productCode,productName:e.name,code:a.code},function(r){e.choosed=!1,"success"==r.message&&0<r.data.length?(e.salePrice=r.data[0].salePrice,e.stock=!0,Tools.prototype.isEmpty(a.faceValue)||e.perValue!=a.faceValue||o.chooseValue(e)):(e.salePrice="",e.stock=!1)}):(e.stock=!1,e.salePrice="")})})});if(o.imgMatch(o.data.giftCardName),o.clearError=function(e){"1"==e?$("#telPho")[0].placeholder="":"2"==e?(Tools.prototype.isEmpty(o.data.telPho)?$("#telPho")[0].placeholder="请输入或选择手机号码":(!Tools.prototype.isMobileNo(o.data.telPho)||Tools.prototype.is170MobileNo(o.data.telPho))&&(o.errorData.phoneNoError=s.errorMsg.orderMsg.phone_no_error),o.data.showCookie=!1):"3"==e?(o.data.telPho="",o.data.showCookie=!1,o.errorData.phoneNoError="",o.errorData.errorMsg="",o.data.mobileType="",o.data.cityin=""):"4"==e&&(o.errorData.phoneNoError="",o.errorData.errorMsg="")},o.clearFaceValue=function(){o.orderForm.perValue="",e.forEach(o.giftCardInfo.faceValueList,function(e,a){e.choosed=!1,e.stock=!1})},o.clearCookie=function(){Tools.prototype.saveCookie("giftCardNoes",null),o.giftCardNoes="",o.data.hasCookie=!1,o.data.showCookie=!1},o.checkPhoneNo=function(e){return o.data.telPho=o.data.telPho.replace(/\D/g,""),o.clearError("4"),o.data.telPho.length>11&&(o.data.telPho=o.data.telPho.substr(0,11)),Tools.prototype.isEmpty(o.data.telPho)?void(o.data.showCookie=!1):(Tools.prototype.isEmpty(o.data.telPho)||"1"!=e||(o.data.showCookie=!0),
void(11==o.data.telPho.length?(o.data.showCookie=!1,Tools.prototype.isMobileNo(o.data.telPho)&&!Tools.prototype.is170MobileNo(o.data.telPho)?("1"==e&&$("#telPho").blur(),i.remove("GiftCardRechargeNo"),i.put("GiftCardRechargeNo",o.data.telPho),d.getPhoneInfo(o.data.telPho,function(e){"success"==e.message?(e.data[0].prvcin==e.data[0].cityin?o.data.cityin=e.data[0].prvcin:o.data.cityin=e.data[0].prvcin+" "+e.data[0].cityin,o.data.cityin+=e.data[0].mobileType,o.data.mobileType=e.data[0].mobileType,i.remove("GiftCardRechargeInfo"),i.put("GiftCardRechargeInfo",o.data.cityin),i.remove("GiftCardTypeInfo"),i.put("GiftCardTypeInfo",o.data.mobileType)):(o.data.mobileType="",o.data.cityin="")})):(o.data.mobileType="",o.data.cityin="",o.errorData.phoneNoError=s.errorMsg.orderMsg.phone_no_error)):(Tools.prototype.isEmpty(o.data.mobileType)&&Tools.prototype.isEmpty(o.data.cityin)||(o.data.cityin="",o.data.mobileType=""),o.errorData.phoneNoError="")))},o.choosePhoneNo=function(e){o.data.telPho=e,o.data.showCookie=!1,o.checkPhoneNo("2")},o.chooseValue=function(r){return o.data.showCookie=!1,Tools.prototype.isEmpty(r.productCode)?(o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock,void(o.data.cash="")):(r.productCode!=o.orderForm.cardId&&a.initMarketInfo(),e.forEach(o.giftCardInfo.faceValueList,function(e,a){r.productCode==e.productCode?(e.stock?(e.choosed=!0,o.orderForm.cardId=e.productCode,o.orderForm.perValue=e.value,o.data.salePrice=e.salePrice):(e.choosed=!1,o.orderForm.cardId="",o.orderForm.perValue="",o.data.salePrice=""),o.getCash()):e.choosed=!1}),void o.clearError("4"))},o.useMarketBill=function(e){return Tools.prototype.isEmpty(o.orderForm.perValue)||Tools.prototype.isEmpty(o.data.cardNum)?a.marketInfo.faceValue=o.orderForm.perValue:a.marketInfo.faceValue=parseInt(o.orderForm.perValue)*parseInt(o.data.cardNum),Tools.prototype.isEmpty(a.userLoginId)?void r.go("login"):void r.go("market",{category:e})},o.isNum=function(e){if(""!=e){o.errorData.errorMsg="";var a=/^[1-9]+[0-9]*]*$/;return a.test(e)?!0:(o.data.cardNum=1,!1)}},o.checkCardNum=function(e){"1"==e?o.isNum(o.data.cardNum)&&(o.data.cardNum<1?o.data.cardNum=1:o.data.cardNum>100&&(o.data.cardNum=100)):"3"==e?100==o.data.cardNum?o.data.cardNum=100:++o.data.cardNum:"2"==e&&(o.data.cardNum>1?--o.data.cardNum:o.data.cardNum=1),o.errorData.errorMsg="",o.getCash(),i.remove("GiftCardCardNum"),i.put("GiftCardCardNum",o.data.cardNum)},o.getCash=function(){Tools.prototype.isEmpty(o.data.cardNum)?o.data.cash="":(o.orderForm.cardNum=o.data.cardNum,Tools.prototype.isEmpty(o.data.salePrice)?o.data.cash="":(o.data.cash=1e3*parseFloat(o.data.salePrice)*parseInt(o.data.cardNum)/1e3,a.marketInfo.faceValue=parseInt(o.orderForm.perValue)*parseInt(o.data.cardNum),a.marketInfo.getDefaultFlag=!0,a.getDefaultMarketBill(o,"4")))},o.setCash=function(){Tools.prototype.isEmpty(a.marketInfo.billId)||(parseFloat(a.marketInfo.cash)>=parseFloat(o.data.cash)?o.data.cash="0":o.data.cash=(1e3*parseFloat(o.data.cash)-1e3*parseFloat(a.marketInfo.cash))/1e3)},!Tools.prototype.isEmpty(o.giftCardInfo.faceValueList)&&(e.forEach(o.giftCardInfo.faceValueList,function(e,a){e.choosed&&!Tools.prototype.isEmpty(e.salePrice)&&(o.data.salePrice=e.salePrice,o.orderForm.cardId=e.productCode,o.orderForm.perValue=e.value,Tools.prototype.isEmpty(i.get("GiftCardCardNum"))||(o.data.cardNum=i.get("GiftCardCardNum")),o.getCash())}),!Tools.prototype.isEmpty(i.get("GiftCardRechargeNo")))){o.data.telPho=i.get("GiftCardRechargeNo");var g=i.get("GiftCardRechargeInfo"),y=i.get("GiftCardTypeInfo");Tools.prototype.isEmpty(g)||(o.data.cityin=g,o.data.mobileType=y)}o.takeOrder=function(e,r){return o.orderForm.cardNum=o.data.cardNum,e.target.disabled=!0,o.data.showCookie=!1,Tools.prototype.isEmpty(o.data.telPho)?(o.errorData.phoneNoError=s.errorMsg.commonMsg.no_phone,void(e.target.disabled=!1)):!Tools.prototype.isMobileNo(o.data.telPho)||Tools.prototype.is170MobileNo(o.data.telPho)?(o.errorData.phoneNoError=s.errorMsg.orderMsg.phone_no_error,void(e.target.disabled=!1)):Tools.prototype.isEmpty(o.orderForm.perValue)?(o.errorData.errorMsg=s.errorMsg.commonMsg.no_face_value,void(e.target.disabled=!1)):Tools.prototype.isEmpty(o.orderForm.cardNum)?(o.errorData.errorMsg=s.errorMsg.commonMsg.no_card_num,void(e.target.disabled=!1)):void d.getGiftCardStock({cardId:o.orderForm.cardId,code:a.code},function(t){return"success"==t.message&&0<t.data.length&&parseInt(t.data[0].purNum)>=parseInt(o.orderForm.cardNum)?(a.bank=r,o.orderForm.telPho=o.data.telPho,o.orderForm.marketBillId=a.marketInfo.billId,n.takeSaleOrder(o.orderForm,function(t){if(a.saveCookies("giftCardNoes",o.orderForm.telPho),"success"==t.message){var c={orderNo:t.data[0].billId,bankCode:r.bankCode,payTypeId:r.payTypeId,payType:r.payType,returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/giftCardrecharge",code:a.code,memberId:a.userLoginId,marketBillId:o.orderForm.marketBillId};"0820"==c.bankCode&&(c.payoutName=t.data[0].cardName),l.getPayUrlForMobile(c,function(a){"success"==a.message?location.href=a.data[0]:o.errorData.errorMsg=s.errorMsg.commonMsg.pay_error,e.target.disabled=!1})}else o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock,e.target.disabled=!1}),void 0):(o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock,void(e.target.disabled=!1))})},Tools.prototype.isEmpty(a.lastUrl)||n.takeSaleOrder(a.lastForm,function(e){if("success"==e.message){var r={orderNo:e.data[0].billId,bankCode:a.bank.bankCode,payTypeId:a.bank.payTypeId,payType:a.bank.payType,returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/giftCardrecharge",code:a.code,memberId:a.userLoginId,marketBillId:a.lastForm.marketBillId};"0820"==r.bankCode&&(r.payoutName=e.data[0].cardName),l.getPayUrlForMobile(r,function(e){"success"==e.message?location.href=e.data[0]:o.errorData.errorMsg=s.errorMsg.commonMsg.pay_error,a.lastUrl="",a.lastForm=""})}else a.lastUrl="",a.lastForm="",o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock})}])}),define("controller/mobile/standard/category/vip-controller",["angular"],function(e){var a=e.module("openwebApp.controller.vip.vipModule",[]);a.controller("VipIndexCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","MessageService","ProductService","MenuService",function(a,o,r,t,c,i,s,d,n){var l=c(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);$("#copyright").html(l),a.menu="viprecharge",a.userData.title="会员",a.curRouter=a.menu,a.rechargeDesc=n.viprecharge.desc}]),a.controller("VipListCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","MessageService","ProductService","MenuService",function(e,a,o,r,t,c,i,s,d){e.menu="viprecharge",e.userData.title="会员",e.curRouter=e.menu,e.rechargeDesc=d.viprecharge.desc,a.letters=s.getLettersList,a.data={search:""},s.getVipList(function(e){"success"==e.message?a.vipList=e.data:a.vipList=""});var n=Tools.prototype.saveCookie("vipList");Tools.prototype.isEmpty(n)?a.rechargeVipList="":a.rechargeVipList=n.split(";"),a.clearSearch=function(e){"1"==e?$("#search")[0].placeholder="":"2"==e?Tools.prototype.isEmpty(a.data.search)&&($("#search")[0].placeholder="请输入会员名称检索"):"3"==e&&(a.data.search="",$("#search")[0].placeholder="请输入会员名称检索")},a.goCharge=function(e){"爱奇艺黄金会员"==e?o.go("vipkamicharge",{gamename:e}):o.go("vipcharge",{gamename:e})}}]),a.controller("VipRechargeCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","$ionicModal","MessageService","ProductService","OrderService","PayService","MenuService",function(a,o,r,t,c,i,s,d,n,l,p,u){var m=c(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);if($("#copyright").html(m),a.menu="vipcharge",a.userData.title="会员",a.curRouter=a.menu,a.rechargeDesc=u.viprecharge.desc,o.data={gameName:t.gamename,gameCount:"",arbitraryNum:"",isArbitrary:!1,cardNum:"",purNum:"",salePrice:"",cash:"",hasCookie:!1,showCookie:!1,imgUrl:""},o.orderForm={orderType:"GAMERECHARGE",gameCount:"",cardNum:"",cardType:0,cardId:"",gameArea:"",gameServer:"",perValue:"",memberId:a.userLoginId,platform:"Mobile",code:a.code,ofLinkId:a.ofLinkId,cardName:""},o.errorData={errorMsg:""},o.imgMatch=function(e){return Tools.prototype.isEmpty(e)?void r.go("viprecharge"):e.indexOf("爱奇艺黄金会员")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/member-qiy.png"):e.indexOf("优酷土豆黄金会员")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/member-youku.png"):e.indexOf("好莱坞会员")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/member-hlw.png"):e.indexOf("新浪微博会员")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/member-xinlang.png"):e.indexOf("迅雷会员")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/member-xl.png"):e.indexOf("搜狐黄金会员")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/member-sh.png"):e.indexOf("乐视会员")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/member-ls.png"):e.indexOf("YY会员")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/member-yy.png"):e.indexOf("QQ超级会员")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/SUPER_QQ.png"):e.indexOf("芒果TV")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/M_TV.png"):e.indexOf("QQ会员")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/QQ02.png"):e.indexOf("Q币充值")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/QB.png"):e.indexOf("CF会员")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/CF.png"):e.indexOf("QQ贵族钻")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/LZ.png"):void 0},o.vipInfo="",Tools.prototype.isEmpty(o.data.gameName)){if(o.vipInfo=n.chargeVipInfo,Tools.prototype.isEmpty(o.vipInfo.name))return void r.go("viprecharge");o.data.gameName=o.vipInfo.name,o.data.cardNum=i.get("VipCardNum")}else n.getVipInfo({code:a.code,productName:o.data.gameName},function(e){return"success"!=e.message?(o.vipInfo="",void r.go("viprecharge")):(n.chargeVipInfo.name=e.data[0].name,n.chargeVipInfo.faceValueList=e.data[0].faceValueList,o.vipInfo=n.chargeVipInfo,void 0)});o.imgMatch(o.data.gameName);var g=Tools.prototype.saveCookie("vipNoes");Tools.prototype.isEmpty(g)?(o.data.hasCookie=!1,o.vipNoes=""):(o.data.hasCookie=!0,o.vipNoes=g.split(";")),o.showCookie=function(){o.data.showCookie=!o.data.showCookie},o.clearCookie=function(){Tools.prototype.saveCookie("vipNoes",null),o.vipNoes="",o.data.hasCookie=!1,o.data.showCookie=!1},o.clearError=function(e){"1"==e?o.errorData.errorMsg="":"2"==e&&(o.data.gameCount="",o.data.showCookie=!1)},o.chooseValue=function(r){o.clearError("1"),o.data.isArbitrary=!1,Tools.prototype.isEmpty(o.data.arbitraryNum)||(o.data.arbitraryNum="",$("#arbitrarycharge")[0].placeholder="任意充"),r.cardId!=o.orderForm.cardId&&a.initMarketInfo(),e.forEach(o.vipInfo.faceValueList,function(e,a){if(r.cardId==e.cardId){if(e.stock){e.choosed=!0,o.orderForm.cardId=e.cardId,o.orderForm.perValue=e.faceValue,o.data.salePrice=e.salePrice,o.data.purNum=e.buyNum,o.data.cardNum="1",i.remove("VipCardNum"),i.put("VipCardNum",o.data.cardNum);var t=e.faceName;"月卡"==t||"年卡"==t||"季卡"==t||"VIP1个月"==t||"VIP3个月"==t||"VIP1年"==t?o.orderForm.cardName=e.faceName:o.orderForm.cardName=""}else e.choosed=!1,o.orderForm.cardId="",o.orderForm.perValue="",o.data.salePrice="",o.data.purNum="",o.data.cardNum="";o.getCash()}else e.choosed=!1})},o.chooseValueForInit=function(r){o.clearError("1"),r.cardId!=o.orderForm.cardId&&a.initMarketInfo(),e.forEach(o.vipInfo.faceValueList,function(e,a){if(r.cardId==e.cardId){if(e.stock){e.choosed=!0,o.orderForm.cardId=e.cardId,o.orderForm.perValue=e.faceValue,o.data.salePrice=e.salePrice,o.data.purNum=e.buyNum,o.data.cardNum="1";var t=e.faceName;"月卡"==t||"年卡"==t||"季卡"==t||"VIP1个月"==t||"VIP3个月"==t||"VIP1年"==t?o.orderForm.cardName=e.faceName:o.orderForm.cardName=""}else e.choosed=!1,o.orderForm.cardId="",o.orderForm.perValue="",o.data.salePrice="",o.data.purNum="",o.data.cardNum="";o.getCash()}else e.choosed=!1})},o.checkCardNum=function(e){"1"==e?o.data.cardNum=o.data.cardNum.replace(/\D/g,""):"2"==e?!Tools.prototype.isEmpty(o.data.cardNum)&&parseInt(o.data.cardNum)>1?o.data.cardNum=parseInt(o.data.cardNum)-1+"":o.data.cardNum="1":"3"==e&&(Tools.prototype.isEmpty(o.data.cardNum)?o.data.cardNum="1":o.data.cardNum=parseInt(o.data.cardNum)+1+""),o.checkCardNumLimit(o.data.cardNum)?(o.errorData.errorMsg="",o.getCash()):(o.errorData.errorMsg=d.errorMsg.commonMsg.card_num_error,o.data.cash="")},o.checkCardNumLimit=function(e){if(Tools.prototype.isEmpty(e))return!1;var a=parseInt(e);if(Tools.prototype.isEmpty(o.data.purNum))return!1;for(var r,t=!1,c=o.data.purNum.split(","),s=0;s<c.length;s++)if(-1!=c[s].indexOf("-")){if(r=c[s].split("-"),a>=parseInt(r[0])&&a<=parseInt(r[1])){t=!0;break}}else if(parseInt(c[s])==a){t=!0;break}return t&&(i.remove("VipCardNum"),i.put("VipCardNum",o.data.cardNum)),t},o.clearArbitraryAmountError=function(a){"1"==a?(o.clearError("1"),Tools.prototype.isEmpty($("#arbitrarycharge")[0])||($("#arbitrarycharge")[0].placeholder=""),o.clearFaceValue("2"),o.data.isArbitrary=!0,e.forEach(o.vipInfo.faceValueList,function(e,a){if(e.arbitrary)if(e.stock){e.choosed=!0,o.orderForm.cardId=e.cardId,o.orderForm.perValue=e.faceValue,o.data.salePrice=e.salePrice,o.data.purNum=e.buyNum,o.data.cardNum="";var r=e.faceName;"月卡"==r||"年卡"==r||"季卡"==r||"VIP1个月"==r||"VIP3个月"==r||"VIP1年"==r?o.orderForm.cardName=e.faceName:o.orderForm.cardName=""}else e.choosed=!1,o.orderForm.cardId="",o.orderForm.perValue="",o.data.salePrice="",o.data.purNum="",o.data.cardNum="",o.data.arbitraryNum="";else e.choosed=!1})):"2"==a&&Tools.prototype.isEmpty(o.data.arbitraryNum)&&($("#arbitrarycharge")[0].placeholder="任意充")},o.clearFaceValue=function(a){Tools.prototype.isEmpty(o.vipInfo)||(e.forEach(o.vipInfo.faceValueList,function(e,a){e.choosed=!1}),"1"==a&&(o.orderForm.cardId="",o.orderForm.perValue="",Tools.prototype.isEmpty(o.data.arbitraryNum)||(o.data.arbitraryNum="",$("#arbitrarycharge")[0].placeholder="任意充")))},o.useMarketBill=function(e){return Tools.prototype.isEmpty(o.orderForm.perValue)||Tools.prototype.isEmpty(o.data.cardNum)?a.marketInfo.faceValue=o.orderForm.perValue:a.marketInfo.faceValue=parseInt(o.orderForm.perValue)*parseInt(o.data.cardNum),Tools.prototype.isEmpty(a.userLoginId)?void r.go("login"):void r.go("market",{category:e})},o.getCash=function(){Tools.prototype.isEmpty(o.data.arbitraryNum)||(o.data.cardNum=o.data.arbitraryNum),!Tools.prototype.isEmpty(o.data.cardNum)&&parseInt(o.data.cardNum)>0?(o.data.cash=1e3*parseFloat(o.data.salePrice)*parseInt(o.data.cardNum)/1e3,a.marketInfo.faceValue=parseInt(o.orderForm.perValue)*parseInt(o.data.cardNum),a.marketInfo.getDefaultFlag=!0,a.getDefaultMarketBill(o,"2")):(o.data.cash="",a.initMarketInfo())},o.setCash=function(){Tools.prototype.isEmpty(a.marketInfo.billId)||(parseFloat(a.marketInfo.cash)>=parseFloat(o.data.cash)?o.data.cash="0":o.data.cash=(1e3*parseFloat(o.data.cash)-1e3*parseFloat(a.marketInfo.cash))/1e3)},o.checkArbitraryAmount=function(e){return Tools.prototype.isEmpty(o.orderForm.cardId)?void(o.data.arbitraryNum=""):(o.data.arbitraryNum=o.data.arbitraryNum.replace(/\D/g,""),void(o.checkCardNumLimit(o.data.arbitraryNum)?(o.errorData.errorMsg="",o.getCash()):(o.errorData.errorMsg=d.errorMsg.commonMsg.card_num_error,o.data.cash="")))},o.checkGameCount=function(e){"1"==e?$("#gameCount")[0].placeholder="":"2"==e?(Tools.prototype.isEmpty(o.data.gameCount)?$("#gameCount")[0].placeholder="请输入会员账号":(i.remove("VipRechargeNo"),i.put("VipRechargeNo",o.data.gameCount)),o.data.showCookie=!1):"3"==e&&(Tools.prototype.isEmpty(o.data.gameCount)?o.data.showCookie=!1:o.data.showCookie=!0)},o.chooseVipNo=function(e){o.data.gameCount=e,o.data.showCookie=!1,i.remove("VipRechargeNo"),i.put("VipRechargeNo",o.data.gameCount)},o.init=function(){Tools.prototype.isEmpty(o.vipInfo.faceValueList)||(e.forEach(o.vipInfo.faceValueList,function(e,a){e.choosed&&e.stock&&(e.arbitrary?(o.data.isArbitrary=!0,o.clearArbitraryAmountError("1")):(o.data.isArbitrary=!1,o.chooseValueForInit(e)),Tools.prototype.isEmpty(i.get("VipCardNum"))?o.data.cardNum="1":(o.data.cardNum=i.get("VipCardNum"),e.arbitrary&&(o.data.arbitraryNum=o.data.cardNum)),o.getCash())}),Tools.prototype.isEmpty(i.get("VipRechargeNo"))||(o.data.gameCount=i.get("VipRechargeNo")))},o.init(),o.takeOrder=function(e,r){return e.target.disabled=!0,Tools.prototype.isEmpty(o.orderForm.cardId)?(o.errorData.errorMsg=d.errorMsg.commonMsg.no_face_value,void(e.target.disabled=!1)):(Tools.prototype.isEmpty(o.data.arbitraryNum)||(o.data.cardNum=o.data.arbitraryNum),Tools.prototype.isEmpty(o.data.cardNum)?(o.errorData.errorMsg=d.errorMsg.commonMsg.no_card_num,void(e.target.disabled=!1)):o.checkCardNumLimit(o.data.cardNum)?Tools.prototype.isEmpty(o.data.gameCount)?(o.errorData.errorMsg=d.errorMsg.commonMsg.no_vip_account,void(e.target.disabled=!1)):(a.bank=r,o.orderForm.cardNum=o.data.cardNum,o.orderForm.gameCount=o.data.gameCount,o.orderForm.marketBillId=a.marketInfo.billId,void l.takeSaleOrder(o.orderForm,function(t){if("success"==t.message){a.saveCookies("vipNoes",o.orderForm.gameCount);var c={orderNo:t.data[0].billId,bankCode:r.bankCode,payTypeId:r.payTypeId,payType:r.payType,returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/viprecharge",code:a.code,memberId:a.userLoginId,marketBillId:o.orderForm.marketBillId};"0820"==c.bankCode&&(c.payoutName=t.data[0].cardName),p.getPayUrlForMobile(c,function(a){"success"==a.message?location.href=a.data[0]:o.errorData.errorMsg=d.errorMsg.commonMsg.pay_error,e.target.disabled=!1})}else o.errorData.errorMsg=d.errorMsg.commonMsg.no_stock,e.target.disabled=!1})):(o.errorData.errorMsg=d.errorMsg.commonMsg.card_num_error,void(e.target.disabled=!1)))},Tools.prototype.isEmpty(a.lastUrl)||l.takeSaleOrder(a.lastForm,function(e){if("success"==e.message){a.saveCookies("vipNoes",o.lastForm.gameCount);var r={orderNo:e.data[0].billId,bankCode:a.bank.bankCode,payTypeId:a.bank.payTypeId,payType:a.bank.payType,returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/viprecharge",code:a.code,memberId:a.userLoginId,marketBillId:a.lastForm.marketBillId};"0820"==r.bankCode&&(r.payoutName=e.data[0].cardName),p.getPayUrlForMobile(r,function(e){"success"==e.message?location.href=e.data[0]:o.errorData.errorMsg=d.errorMsg.commonMsg.pay_error,a.lastUrl="",a.lastForm=""})}else a.lastUrl="",a.lastForm="",o.errorData.errorMsg=d.errorMsg.commonMsg.no_stock})}]),a.controller("KamiRechargeCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","MessageService","ProductService","OrderService","PayService","MenuService",function(a,o,r,t,c,i,s,d,n,l,p){var u=c(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);$("#copyright").html(u),a.menu="vipkamicharge",a.userData.title="会员",a.curRouter=a.menu,a.rechargeDesc=p.viprecharge.desc;t.telPho;if(o.data={vipCardName:t.gamename,arbitraryNum:"",cardNum:"1",salePrice:"",cash:"",cityin:"",mobileType:"",hasCookie:!1,showCookie:!1,cookieData:"",telPho:"",imgUrl:""},o.payList=a.userData.payList,o.orderForm={orderType:"CARDPASSRECHARGE",cardNum:"",cardType:0,cardId:"",perValue:"",memberId:a.userLoginId,platform:"Mobile",code:a.code,telPho:"",ofLinkId:a.ofLinkId},o.errorData={phoneNoError:"",errorMsg:""},o.imgMatch=function(e){return Tools.prototype.isEmpty(e)?void r.go("viprecharge"):e.indexOf("爱奇艺黄金会员")>-1?void(o.data.imgUrl="http://pic.ofcard.com/cards/standard/img/member-qiy.png"):void 0},o.vipCardInfo="",Tools.prototype.isEmpty(o.data.vipCardName)){if(o.vipCardInfo=d.chargeVipInfo,Tools.prototype.isEmpty(o.vipCardInfo.name))return void r.go("viprecharge");o.data.vipCardName=o.vipCardInfo.name}else d.getVipInfo({code:a.code,productName:o.data.vipCardName},function(e){return"success"!=e.message?(o.vipCardInfo="",void r.go("viprecharge")):(d.chargeVipInfo.faceValueList=e.data[0].faceValueList,o.vipCardInfo=d.chargeVipInfo,o.vipCardInfo.name=o.data.vipCardName,void 0)});o.imgMatch(o.data.vipCardName);var m=Tools.prototype.saveCookie("vipCardNoes");if(Tools.prototype.isEmpty(m)?(o.data.hasCookie=!1,o.vipCardNoes=""):(o.data.hasCookie=!0,o.vipCardNoes=m.split(";")),o.showCookie=function(){o.data.showCookie=!o.data.showCookie},o.clearError=function(e){"1"==e?$("#telPho")[0].placeholder="":"2"==e?(Tools.prototype.isEmpty(o.data.telPho)?$("#telPho")[0].placeholder="请输入或选择手机号码":(!Tools.prototype.isMobileNo(o.data.telPho)||Tools.prototype.is170MobileNo(o.data.telPho))&&(o.errorData.phoneNoError=s.errorMsg.orderMsg.phone_no_error),o.data.showCookie=!1):"3"==e?(o.data.telPho="",o.data.showCookie=!1,o.errorData.phoneNoError="",o.errorData.errorMsg="",o.data.mobileType="",o.data.cityin=""):"4"==e&&(o.errorData.phoneNoError="",o.errorData.errorMsg="")},o.clearFaceValue=function(){o.orderForm.perValue="",e.forEach(o.vipCardInfo.faceValueList,function(e,a){e.choosed=!1,e.stock=!1})},o.clearCookie=function(){Tools.prototype.saveCookie("vipCardNoes",null),o.vipCardNoes="",o.data.hasCookie=!1,o.data.showCookie=!1},o.checkPhoneNo=function(e){return o.data.telPho=o.data.telPho.replace(/\D/g,""),o.clearError("4"),o.data.telPho.length>11&&(o.data.telPho=o.data.telPho.substr(0,11)),Tools.prototype.isEmpty(o.data.telPho)?void(o.data.showCookie=!1):(Tools.prototype.isEmpty(o.data.telPho)||"1"!=e||(o.data.showCookie=!0),void(11==o.data.telPho.length?(o.data.showCookie=!1,Tools.prototype.isMobileNo(o.data.telPho)&&!Tools.prototype.is170MobileNo(o.data.telPho)?("1"==e&&$("#telPho").blur(),i.remove("VipCardRechargeNo"),i.put("VipCardRechargeNo",o.data.telPho),d.getPhoneInfo(o.data.telPho,function(e){"success"==e.message?(e.data[0].prvcin==e.data[0].cityin?o.data.cityin=e.data[0].prvcin:o.data.cityin=e.data[0].prvcin+" "+e.data[0].cityin,o.data.cityin+=e.data[0].mobileType,o.data.mobileType=e.data[0].mobileType,i.remove("VipCardRechargeInfo"),i.put("VipCardRechargeInfo",o.data.cityin),i.remove("GiftCardTypeInfo"),i.put("GiftCardTypeInfo",o.data.mobileType)):(o.data.mobileType="",o.data.cityin="")})):(o.data.mobileType="",o.data.cityin="",o.errorData.phoneNoError=s.errorMsg.orderMsg.phone_no_error)):(Tools.prototype.isEmpty(o.data.mobileType)&&Tools.prototype.isEmpty(o.data.cityin)||(o.data.cityin="",o.data.mobileType=""),o.errorData.phoneNoError="")))},o.choosePhoneNo=function(e){o.data.telPho=e,o.data.showCookie=!1,o.checkPhoneNo("2")},o.chooseValue=function(r){return o.data.showCookie=!1,Tools.prototype.isEmpty(r.cardId)?(o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock,void(o.data.cash="")):(r.cardId!=o.orderForm.cardId&&a.initMarketInfo(),e.forEach(o.vipCardInfo.faceValueList,function(e,a){r.cardId==e.cardId?(e.stock?(e.choosed=!0,o.orderForm.cardId=e.cardId,o.orderForm.perValue=e.faceValue,o.data.salePrice=e.salePrice,o.data.purNum=e.buyNum,o.data.cardNum=1,i.remove("VipCardCardNum"),i.put("VipCardCardNum",o.data.cardNum)):(e.choosed=!1,o.orderForm.cardId="",o.orderForm.perValue="",o.data.salePrice="",o.data.purNum="",o.data.cardNum=""),o.getCash()):e.choosed=!1}),void o.clearError("4"))},o.useMarketBill=function(e){return Tools.prototype.isEmpty(o.orderForm.perValue)||Tools.prototype.isEmpty(o.data.cardNum)?a.marketInfo.faceValue=o.orderForm.perValue:a.marketInfo.faceValue=parseInt(o.orderForm.perValue)*parseInt(o.data.cardNum),Tools.prototype.isEmpty(a.userLoginId)?void r.go("login"):void r.go("market",{category:e})},o.isNum=function(e){if(""!=e){o.errorData.errorMsg="";var a=/^[1-9]+[0-9]*]*$/;return a.test(e)?!0:(o.data.cardNum=1,!1)}},o.checkCardNum=function(e){"1"==e?o.isNum(o.data.cardNum)&&(o.data.cardNum<1?o.data.cardNum=1:o.data.cardNum>10&&(o.data.cardNum=10)):"3"==e?10==o.data.cardNum?o.data.cardNum=10:++o.data.cardNum:"2"==e&&(o.data.cardNum>1?--o.data.cardNum:o.data.cardNum=1),o.errorData.errorMsg="",o.getCash(),i.remove("VipCardCardNum"),i.put("VipCardCardNum",o.data.cardNum)},o.getCash=function(){Tools.prototype.isEmpty(o.data.cardNum)?o.data.cash="":(o.orderForm.cardNum=o.data.cardNum,Tools.prototype.isEmpty(o.data.salePrice)?o.data.cash="":(o.data.cash=1e3*parseFloat(o.data.salePrice)*parseInt(o.data.cardNum)/1e3,a.marketInfo.faceValue=parseInt(o.orderForm.perValue)*parseInt(o.data.cardNum),a.marketInfo.getDefaultFlag=!0,a.getDefaultMarketBill(o,"4")))},o.setCash=function(){Tools.prototype.isEmpty(a.marketInfo.billId)||(parseFloat(a.marketInfo.cash)>=parseFloat(o.data.cash)?o.data.cash="0":o.data.cash=(1e3*parseFloat(o.data.cash)-1e3*parseFloat(a.marketInfo.cash))/1e3)},!Tools.prototype.isEmpty(o.vipCardInfo.faceValueList)&&(e.forEach(o.vipCardInfo.faceValueList,function(e,a){e.choosed&&!Tools.prototype.isEmpty(e.salePrice)&&(o.data.purNum=e.buyNum,o.data.salePrice=e.salePrice,o.orderForm.cardId=e.cardId,o.orderForm.perValue=e.faceValue,Tools.prototype.isEmpty(i.get("VipCardCardNum"))?o.data.cardNum=1:o.data.cardNum=i.get("VipCardCardNum"),o.getCash())}),!Tools.prototype.isEmpty(i.get("VipCardRechargeNo")))){o.data.telPho=i.get("VipCardRechargeNo");var g=i.get("VipCardRechargeInfo"),y=i.get("VipCardTypeInfo");Tools.prototype.isEmpty(g)||(o.data.cityin=g,o.data.mobileType=y)}o.takeOrder=function(e,r){return o.orderForm.cardNum=o.data.cardNum,e.target.disabled=!0,o.data.showCookie=!1,Tools.prototype.isEmpty(o.data.telPho)?(o.errorData.phoneNoError=s.errorMsg.commonMsg.no_phone,void(e.target.disabled=!1)):!Tools.prototype.isMobileNo(o.data.telPho)||Tools.prototype.is170MobileNo(o.data.telPho)?(o.errorData.phoneNoError=s.errorMsg.orderMsg.phone_no_error,void(e.target.disabled=!1)):Tools.prototype.isEmpty(o.orderForm.perValue)?(o.errorData.errorMsg=s.errorMsg.commonMsg.no_face_value,void(e.target.disabled=!1)):Tools.prototype.isEmpty(o.orderForm.cardNum)?(o.errorData.errorMsg=s.errorMsg.commonMsg.no_card_num,void(e.target.disabled=!1)):void d.getVipCardStock({cardId:o.orderForm.cardId,code:a.code},function(t){return"success"==t.message&&0<t.data.length&&parseInt(t.data[0].purNum)>=parseInt(o.orderForm.cardNum)?(a.bank=r,o.orderForm.telPho=o.data.telPho,o.orderForm.marketBillId=a.marketInfo.billId,n.takeSaleOrder(o.orderForm,function(t){if(a.saveCookies("vipCardNoes",o.orderForm.telPho),"success"==t.message){var c={orderNo:t.data[0].billId,bankCode:r.bankCode,payTypeId:r.payTypeId,payType:r.payType,returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/viprecharge",code:a.code,memberId:a.userLoginId,marketBillId:o.orderForm.marketBillId};"0820"==c.bankCode&&(c.payoutName=t.data[0].cardName),l.getPayUrlForMobile(c,function(a){"success"==a.message?location.href=a.data[0]:o.errorData.errorMsg=s.errorMsg.commonMsg.pay_error,e.target.disabled=!1})}else o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock,e.target.disabled=!1}),void 0):(o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock,void(e.target.disabled=!1))})},Tools.prototype.isEmpty(a.lastUrl)||n.takeSaleOrder(a.lastForm,function(e){if("success"==e.message){var r={orderNo:e.data[0].billId,bankCode:a.bank.bankCode,payTypeId:a.bank.payTypeId,payType:a.bank.payType,returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/viprecharge",code:a.code,memberId:a.userLoginId,marketBillId:a.lastForm.marketBillId};"0820"==r.bankCode&&(r.payoutName=e.data[0].cardName),l.getPayUrlForMobile(r,function(e){"success"==e.message?location.href=e.data[0]:o.errorData.errorMsg=s.errorMsg.commonMsg.pay_error,a.lastUrl="",a.lastForm=""})}else a.lastUrl="",a.lastForm="",o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock})}])}),define("controller/mobile/standard/category/public-controller",["angular"],function(e){var a=e.module("openwebApp.controller.public.publicModule",[]);a.controller("PublicRechargeCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","MessageService","ProductService","OrderService","PayService","MenuService","MemberService",function(a,o,r,t,c,i,s,d,n,l,p,u){var m=c(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);$("#copyright").html(m),a.userData.title="水电煤",a.menu="publicrecharge",a.curRouter=a.menu,a.rechargeDesc=p.publicrecharge.desc;var g=t.publicNo;if(o.data={gameCount:"",cash:"",prov:"",city:"",provNo:"",cityNo:"",payUnitName:"",mobileType:"",hasCookie:!1,showCookie:!1,cookieData:"",projectTypeId:"c2680",selectedPayUnit:null},o.errorData={errorMsg:"",agreementMsg:"",cardMsg:"",orderMsg:"",areaMsg:"",cityMsg:""},Tools.prototype.isEmpty(a.publicData)){a.publicData={code:a.code,gameCount:"",cash:"",prov:"",useCity:"",provinceName:"",useCityId:"",provinceId:"",payUnitId:"",payUnitName:"",pebarCd:"",supItemTplId:"",payProjectId:"v2620",projectTypeId:o.data.projectTypeId,cardid:"",accountName:"",balance:"",payUnitList:"",payMentDay:"",arreasInfoList:"",selectedArreasInfo:""};var y=i.get("PublicLoginCity");if(i.remove("PublicLoginCity"),!Tools.prototype.isEmpty(i.get("PublicRechargeCity"))){var h=i.get("PublicRechargeCity");Tools.prototype.isEmpty(h)||(a.publicData.useCity=h)}d.queryAreaByIp(function(e){"success"==e.message&&0<e.data.length&&(Tools.prototype.isEmpty(a.publicData.useCity)&&(a.publicData.useCity=e.data[0]),Tools.prototype.isEmpty(a.userLoginId)&&(a.publicData.useCity=e.data[0]),Tools.prototype.isEmpty(y)||e.data[0]!=a.publicData.useCity&&(o.errorData.cityMsg=e.data[0])),Tools.prototype.isEmpty(a.publicData.useCity)&&(a.publicData.useCity="北京"),o.data.city=a.publicData.useCity,d.getPublicArea(a.publicData,function(e){"success"==e.message&&0<e.data.length&&(a.publicData.provinceName=e.data[0].province,a.publicData.useCityId=e.data[0].useCityId,a.publicData.provinceId=e.data[0].provinceId,d.getPayUnitList(a.publicData,function(e){"success"==e.message&&0<e.data.length?(a.publicData.payUnitId=e.data[0].payUnitId,a.publicData.payUnitName=e.data[0].payUnitName,a.publicData.payUnitList=e.data,o.data.payUnitName=e.data[0].payUnitName,o.data.selectedPayUnit=e.data[0],o.errorData.areaMsg=""):(a.publicData.payUnitId="",a.publicData.payUnitName="",a.publicData.payUnitList=null,o.data.payUnitName="",o.data.selectedPayUnit=null,"c2670"==o.data.projectTypeId?o.errorData.areaMsg="水费":"c2680"==o.data.projectTypeId?o.errorData.areaMsg="电费":"c2681"==o.data.projectTypeId&&(o.errorData.areaMsg="煤气费"))}))})})}else{var y=i.get("PublicLoginCity");i.remove("PublicLoginCity"),d.queryAreaByIp(function(e){"success"==e.message&&0<e.data.length&&e.data[0]!=a.publicData.useCity&&(Tools.prototype.isEmpty(y)||(o.errorData.cityMsg=e.data[0])),d.getPublicArea(a.publicData,function(e){"success"==e.message&&0<e.data.length&&(a.publicData.provinceName=e.data[0].province,a.publicData.useCityId=e.data[0].useCityId,a.publicData.provinceId=e.data[0].provinceId,d.getPayUnitList(a.publicData,function(e){"success"==e.message&&0<e.data.length?(a.publicData.payUnitId=e.data[0].payUnitId,a.publicData.payUnitName=e.data[0].payUnitName,a.publicData.payUnitList=e.data,o.data.payUnitName=e.data[0].payUnitName,o.data.selectedPayUnit=e.data[0],o.errorData.areaMsg=""):(a.publicData.payUnitId="",a.publicData.payUnitName="",a.publicData.payUnitList=null,o.data.payUnitName="",o.data.selectedPayUnit=null,"c2670"==o.data.projectTypeId?o.errorData.areaMsg="水费":"c2680"==o.data.projectTypeId?o.errorData.areaMsg="电费":"c2681"==o.data.projectTypeId&&(o.errorData.areaMsg="煤气费"))}))})})}o.refreshPublicArea=function(){d.getPublicArea(a.publicData,function(e){"success"==e.message&&0<e.data.length&&(a.publicData.provinceName=e.data[0].province,a.publicData.useCityId=e.data[0].useCityId,a.publicData.provinceId=e.data[0].provinceId,d.getPayUnitList(a.publicData,function(e){"success"==e.message&&0<e.data.length?(a.publicData.payUnitId=e.data[0].payUnitId,a.publicData.payUnitName=e.data[0].payUnitName,a.publicData.payUnitList=e.data,o.data.payUnitName=e.data[0].payUnitName,o.data.selectedPayUnit=e.data[0],o.errorData.areaMsg=""):(a.publicData.payUnitId="",a.publicData.payUnitName="",a.publicData.payUnitList=null,o.data.payUnitName="",o.data.selectedPayUnit=null,"c2670"==o.data.projectTypeId?o.errorData.areaMsg="水费":"c2680"==o.data.projectTypeId?o.errorData.areaMsg="电费":"c2681"==o.data.projectTypeId&&(o.errorData.areaMsg="煤气费"))}))})},o.data.city=a.publicData.useCity,
o.data.projectTypeId=a.publicData.projectTypeId,o.payList=a.userData.payList,o.orderForm={orderType:"PHONERECHARGE",cardNum:"1",cardType:0,cardId:"",memberId:a.userLoginId,platform:"Mobile",code:a.code},o.choosePublicUnit=function(e,o){a.publicData.payUnitId=e,a.publicData.payUnitName=o},o.notChangeCity=function(){o.errorData.cityMsg="",i.remove("PublicRechargeCity"),i.put("PublicRechargeCity",a.publicData.useCity),o.refreshPublicArea()},o.doChangeCity=function(){a.publicData.useCity=o.errorData.cityMsg,o.data.city=o.errorData.cityMsg,o.errorData.cityMsg="",i.remove("PublicRechargeCity"),i.put("PublicRechargeCity",a.publicData.useCity),o.refreshPublicArea()};var f=Tools.prototype.saveCookie("publicNoes");if(Tools.prototype.isEmpty(f)?(o.data.hasCookie=!1,o.publicNoes=""):(o.data.hasCookie=!0,o.publicNoes=f.split(";"),o.publicNoes.length>0&&(o.data.gameCount=f.split(";")[0])),o.chooseProjectType=function(e){o.data.projectTypeId=e,a.publicData.projectTypeId=e,o.refreshPublicArea(),o.errorData.areaMsg="",o.errorData.errorMsg=""},o.chooseCity=function(){r.go("publicCity",{})},o.showCookie=function(){o.data.showCookie=!o.data.showCookie},o.clearCookie=function(){Tools.prototype.saveCookie("publicNoes",null),o.publicNoes="",o.data.hasCookie=!1,o.data.showCookie=!1},o.clearError=function(e){"1"==e?$("#gameCount")[0].placeholder="":"2"==e?(Tools.prototype.isEmpty(o.data.gameCount)&&($("#gameCount")[0].placeholder="请输入户号"),a.publicData.gameCount=o.data.gameCount,o.data.showCookie=!1):"3"==e?(o.data.gameCount="",o.data.showCookie=!1,o.errorData.errorMsg="",o.data.mobileType="",o.data.cityin=""):"4"==e&&(o.errorData.errorMsg="")},o.checkPublicNo=function(e){o.data.gameCount=o.data.gameCount.replace(/\D/g,""),o.clearError("4"),o.data.gameCount.length>30&&(o.data.gameCount=o.data.gameCount.substr(0,30)),Tools.prototype.isEmpty(o.data.gameCount)?o.data.showCookie=!1:Tools.prototype.isEmpty(o.data.gameCount)||"1"!=e||o.data.hasCookie&&(o.data.showCookie=!0)},o.choosePublicNo=function(e){o.data.gameCount=e,o.data.showCookie=!1,o.checkPublicNo("2")},o.queryPublicBill=function(e){return e.target.disabled=!0,a.publicData.gameCount=o.data.gameCount,Tools.prototype.isEmpty(a.userLoginId)?(e.target.disabled=!1,void r.go("login")):null==o.data.gameCount||""==o.data.gameCount?(o.errorData.errorMsg=s.errorMsg.commonMsg.no_publicNo,void(e.target.disabled=!1)):null==a.publicData.payUnitName||""==a.publicData.payUnitName?(o.errorData.errorMsg=s.errorMsg.commonMsg.no_publicUnit,void(e.target.disabled=!1)):(a.publicData.pebarCd=o.data.gameCount,void d.queryPublicInfo(a.publicData,function(t){(0==t.message||0==t.data.length)&&(o.errorData.errorMsg=s.errorMsg.commonMsg.wrong_publicNo,e.target.disabled=!1),Tools.prototype.isEmpty(t.data[0])&&(o.errorData.errorMsg=s.errorMsg.commonMsg.wrong_publicNo,e.target.disabled=!1),"success"==t.message&&0<t.data.length&&(a.publicData.arreasInfoList=t.data,a.publicData.selectedArreasInfo=t.data[0],a.publicData.accountName=t.data[0].accountName,a.publicData.balance=t.data[0].balance,a.publicData.payMentDay=t.data[0].payMentDay,a.publicData.cardid=t.data[0].outProductId,a.publicData.supItemTplId=t.data[0].supItemTplId,a.saveCookies("publicNoes",o.data.gameCount),i.remove("PublicRechargeNo"),i.put("PublicRechargeNo",o.data.gameCount),i.remove("PublicRechargeCity"),i.put("PublicRechargeCity",a.publicData.useCity),e.target.disabled=!1,r.go("publicQuery",{}))}))},Tools.prototype.isEmpty(g))if(Tools.prototype.isEmpty(a.publicData)||Tools.prototype.isEmpty(a.publicData.gameCount))if(Tools.prototype.isEmpty(i.get("PublicRechargeNo")))Tools.prototype.isEmpty(a.rechargeAccount)||(o.data.gameCount=a.rechargeAccount,o.checkPublicNo("2"));else{var b=i.get("PublicRechargeNo");Tools.prototype.isEmpty(b)||(o.data.gameCount=b)}else o.data.gameCount=a.publicData.gameCount;else a.rechargeAccount="",a.faceValue="",o.data.gameCount=g,o.checkPublicNo("2")}]),a.controller("PublicQueryCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","MessageService","ProductService","OrderService","PayService","MenuService",function(a,o,r,t,c,i,s,d,n,l,p){var u=c(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);$("#copyright").html(u),a.userData.title="水电煤",a.menu="publicQuery",a.curRouter=a.menu,a.rechargeDesc=p.publicrecharge.desc,o.data={gameCount:"",cash:"",cityin:"",mobileType:"",hasCookie:!1,showCookie:!1,cookieData:"",projectTypeId:"",name:"",item:"",cardid:"",payMentDay:"",arreasInfoList:"",selectedArreasInfo:""},o.errorData={errorMsg:"",agreementMsg:"",cardMsg:"",orderMsg:""},Tools.prototype.isEmpty(a.publicData)&&(r.go("publicrecharge",{}),o.errorData.errorMsg="请在查询页面点击查询后再进行支付"),o.data.name=a.publicData.accountName,o.data.item=a.publicData.payUnitName,o.data.projectTypeId=a.publicData.projectTypeId,o.data.cash=a.publicData.balance,o.data.gameCount=a.publicData.pebarCd,o.payList=a.userData.payList,o.data.cardid=a.publicData.cardid,o.data.arreasInfoList=a.publicData.arreasInfoList,o.data.selectedArreasInfo=a.publicData.selectedArreasInfo,o.orderForm={orderType:"PUBLICRECHARGE",cardNum:o.data.cash,perValue:"1",cardType:0,cardId:a.publicData.cardid,memberId:a.userLoginId,platform:"Mobile",code:a.code,cityin:a.publicData.useCityId,prvcin:a.publicData.provinceId,gameCount:a.publicData.pebarCd,supItemTplId:a.publicData.supItemTplId,provinceName:a.publicData.provinceName,useCity:a.publicData.useCity,payProjectId:a.publicData.payProjectId,projectTypeId:a.publicData.projectTypeId,payUnitId:a.publicData.payUnitId,payUnitName:a.publicData.payUnitName,marketBillId:"",ofLinkId:a.ofLinkId,payMentDay:a.publicData.payMentDay},""==o.data.cash&&""==o.data.gameCount&&r.go("publicrecharge",{}),o.choosePayMentDay=function(e,a){o.data.cash=e,o.data.payMentDay=a},o.takeOrder=function(e,r){return e.target.disabled=!0,o.data.showCookie=!1,Tools.prototype.isEmpty(o.data.gameCount)?(o.errorData.errorMsg=s.errorMsg.commonMsg.no_publicNo,void(e.target.disabled=!1)):Tools.prototype.isEmpty(o.data.cash)?(o.errorData.errorMsg=s.errorMsg.commonMsg.wrong_cash,void(e.target.disabled=!1)):(a.bank=r,o.orderForm.cardId=a.publicData.cardid,o.orderForm.gameCount=o.data.gameCount,o.orderForm.cardNum=o.data.cash,o.orderForm.payMentDay=o.data.payMentDay,void n.takeSaleOrder(o.orderForm,function(t){if("success"==t.message){var c={orderNo:t.data[0].billId,bankCode:r.bankCode,payTypeId:r.payTypeId,payType:r.payType,returnUrl:"http://web.yiqianlian.com/mobile/success/"+a.code+"/publicrecharge",code:a.code,memberId:a.userLoginId,marketBillId:o.orderForm.marketBillId};"0820"==c.bankCode&&(c.payoutName=t.data[0].cardName),l.getPayUrlForMobile(c,function(a){"success"==a.message?location.href=a.data[0]:o.errorData.errorMsg=s.errorMsg.commonMsg.pay_error,e.target.disabled=!1})}else o.errorData.errorMsg=s.errorMsg.commonMsg.no_stock,e.target.disabled=!1}))}}]),a.controller("PublicCityCtrl",["$rootScope","$scope","$state","$stateParams","$compile","$cookieStore","$location","$anchorScroll","MessageService","ProductService","OrderService","PayService","MenuService",function(a,o,r,t,c,i,s,d,n,l,p,u,m){var g=c(e.element("<"+a.userData.copyright+"></"+a.userData.copyright+">"))(o);$("#copyright").html(g),a.userData.title="水电煤",a.menu="publicrecharge",a.curRouter=a.menu,a.rechargeDesc=m.publicrecharge.desc;t.publicNo;o.data={gameCount:"",cash:"",city:"",provinceName:"",cityId:"",provinceId:"",mobileType:"",hasCookie:!1,showCookie:!1,cookieData:"",projectTypeId:"",name:"",item:""},Tools.prototype.isEmpty(a.publicData)&&(a.publicData={code:a.code,gameCount:"",cash:"",prov:"",useCity:"",provinceName:"",useCityId:"",provinceId:"",payUnitId:"",payUnitName:"",pebarCd:"",supItemTplId:"",payProjectId:"v2620",projectTypeId:o.data.projectTypeId,cardid:"",accountName:"",balance:"",payUnitList:""}),l.queryAreaByIp(function(e){"success"==e.message&&0<e.data.length&&(o.data.city=e.data[0],Tools.prototype.isEmpty(o.data.city)||l.getPublicArea(a.publicData,function(e){"success"==e.message&&0<e.data.length&&(o.data.provinceName=e.data[0].province,o.data.cityId=e.data[0].useCityId,o.data.provinceId=e.data[0].provinceId)}))}),o.changeCityList=function(e){for(var a=new Array,r=0;r<o.baseCityList.length;r++){for(var t=o.baseCityList[r],c=new Array,i=0;i<t.cityInfoList.length;i++){var s=t.cityInfoList[i].useCity;s.indexOf(e)>-1&&c.push(t.cityInfoList[i])}c.length>0&&(t.cityInfoList=c,a.push(t))}o.cityList=a},o.clearCity=function(){o.queryValue="",o.cityList=o.baseCityList},o.chooseAreaCity=function(e,t,c,s){a.publicData.provinceId=o.data.provinceId,a.publicData.province=o.data.provinceName,a.publicData.useCityId=o.data.cityId,a.publicData.useCity=o.data.city,i.remove("PublicRechargeCity"),i.put("PublicRechargeCity",a.publicData.useCity),r.go("publicrecharge",{})},o.chooseCity=function(e,o,t,c){a.publicData.provinceId=e,a.publicData.province=o,a.publicData.useCityId=t,a.publicData.useCity=c,i.remove("PublicRechargeCity"),i.put("PublicRechargeCity",a.publicData.useCity),r.go("publicrecharge",{})},l.getPublicCity({belongTo:""},function(e){"success"==e.message&&0<e.data.length&&(o.cityList=e.data,o.baseCityList=e.data)})}])}),define("controller/mobile/standard/main-controller-mobile",["angular","./common/common-controller","./category/phone-controller","./category/flow-controller","./category/gas-controller","./category/game-controller","./category/giftCard-controller","./category/vip-controller","./category/public-controller"],function(e){e.module("openwebApp.controllers",["openwebApp.controller.common.commonModule","openwebApp.controller.phone.phoneModule","openwebApp.controller.flow.flowModule","openwebApp.controller.gas.gasModule","openwebApp.controller.game.gameModule","openwebApp.controller.giftCard.giftCardModule","openwebApp.controller.vip.vipModule","openwebApp.controller.public.publicModule"])}),define("directive/mobile/standard/common/common-directive",["angular"],function(e){var a=e.module("openwebApp.directive.common.commonModule",[]);a.directive("copyright",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'==uuid" class="link-phone" ng-click ="login()">{{userData.loginTitle}} <span ng-bind="userData.loginOut"></span> | </a><a ng-if="\'\'!=uuid"><span>您已登录</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a>｜<a ng-click="showRechargeDesc()">充值说明</a></p><p class="logo"><a href="http://eqxiu.com/s/6swATl6d" target="_blank"><img src="http://pic.ofcard.com/cards/mobile/img/ofcard-logo.png" style="width: 78px;"></a><br>本服务由易嵌联授权提供</p></div>',replace:!0}}]),a.directive("copyright2",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'==uuid" class="link-phone" ng-click ="login()">{{userData.loginTitle}} <span ng-bind="userData.loginOut"></span> | </a><a ng-if="\'\'!=uuid"><span>您已登录</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a>｜<a ng-click="showRechargeDesc()">充值说明</a></p></div>',replace:!0}}]),a.directive("ddbcopyright",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'!=uuid"><span>您已登录</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a>｜<a ng-click="showRechargeDesc()">充值说明</a></p></div>',replace:!0}}]),a.directive("itoolscopyright",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'==uuid" class="link-phone" ng-click ="login()">{{userData.loginTitle}} <span ng-bind="userData.loginOut"></span> | </a><a ng-if="\'\'!=uuid"><span>您已登录</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a>｜<a ng-click="showRechargeDesc()">充值说明</a></p><p class="logo"><a href="http://eqxiu.com/s/6swATl6d" target="_blank"><img src="http://pic.ofpay.com/cards/standard/img/logo-itools.png" style="width: 130px;"></a><br>本服务由易嵌联授权提供</p></div>',replace:!0}}]),a.directive("xingyeheader",["$rootScope",function(e){return{restrict:"E",template:'<div class="bar bar-header bar-positive"><a class="button button-icon icon ion-ios7-arrow-back button-icon-font" href="{{mallUrl}}">返回商城 </a><h1 class="title"></h1></div>',replace:!0}}]),a.directive("xingyeoldheader",["$rootScope",function(e){return{restrict:"E",template:'<div class="bar bar-header bar-positive"><a class="button button-icon icon ion-ios7-arrow-back"  href="{{mallUrlOld}}"> </a><h1 class="title">加油卡</h1></div>',replace:!0}}]),a.directive("spdbcopyright",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'==uuid" class="link-phone" ng-click ="login()">{{userData.loginTitle}} <span ng-bind="userData.loginOut"></span> | </a><a ng-if="\'\'!=uuid"><span>您已登录</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a>｜<a ng-click="showRechargeDesc()">充值说明</a></p><p class="logo"><a href="http://eqxiu.com/s/6swATl6d" target="_blank"><img src="http://pic.ofpay.com/cards/standard/img/pfbank.png" style="width: 78px;"></a><br>本服务由易嵌联授权提供</p></div>',replace:!0}}]),a.directive("mdlcopyright",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'==uuid" class="link-phone" ng-click ="login()">{{userData.loginTitle}} <span ng-bind="userData.loginOut"></span> | </a><a ng-if="\'\'!=uuid"><span>您已登录</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a>｜<a ng-click="showRechargeDesc()">充值说明</a></p></div>',replace:!0}}]),a.directive("yichacopyright",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'==uuid" class="link-phone" ng-click="login()">{{userData.loginTitle}}<span ng-bind="userData.loginOut"></span> | </a><a ng-if="\'\'!=uuid"><span>您已登陆</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a> | <a ng-click="showRechargeDesc()">充值说明</a></p></div>',replace:!0}}]),a.directive("cjwcopyright",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'==uuid" class="link-phone" ng-click ="login()">{{userData.loginTitle}} <span ng-bind="userData.loginOut"></span> | </a><a ng-if="\'\'!=uuid"><span>您已登录</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a>｜<a ng-click="showRechargeDesc()">充值说明</a></p><p class="logo"><a href="http://cjwsc.com" target="_blank"><img src="http://pic.ofcard.com/cards/mobile/img/ofcard-logo2.png" style="width: 78px;"></a><br>本服务由易嵌联授权提供</p></div>',replace:!0}}]),a.directive("njfbcopyright",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'==uuid" class="link-phone" ng-click ="login()">{{userData.loginTitle}} <span ng-bind="userData.loginOut"></span> | </a><a ng-if="\'\'!=uuid"><span>您已登录</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a>｜<a ng-click="showRechargeDesc()">充值说明</a></p><p class="logo"><a target="_blank"><img src="http://pic.ofcard.com/cards/mobile/img/viva-logo.png" style="  width: 90px;height: 25px;"></a> | <a href="http://eqxiu.com/s/6swATl6d" target="_blank"><img src="http://pic.ofcard.com/cards/mobile/img/ofcard-logo.png" style="width: 78px;"><br>维瓦数字&欧飞提供技术支持</p></div>',replace:!0}}]),a.directive("yxtcopyright",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'==uuid" class="link-phone" ng-click ="login()">{{userData.loginTitle}} <span ng-bind="userData.loginOut"></span> | </a><a ng-if="\'\'!=uuid"><span>您已登录</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a>｜<a ng-click="showRechargeDesc()">充值说明</a></p><p class="logo"><a href="http://eqxiu.com/s/6swATl6d" target="_blank"><img src="http://pic.ofcard.com/cards/mobile/img/ofcard-logo-yxt.png" style="width: 78px;"></a><br>本服务由易嵌联授权提供</p></div>',replace:!0}}]),a.directive("copyright116114",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'==uuid" class="link-phone" ng-click ="login()">{{userData.loginTitle}} <span ng-bind="userData.loginOut"></span> | </a><a ng-if="\'\'!=uuid"><span>您已登录</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a>｜<a ng-click="showRechargeDesc()">充值说明</a></p><p class="logo"><a href="http://eqxiu.com/s/6swATl6d" target="_blank"><img src="http://pic.ofcard.com/cards/mobile/img/ofcard-logo-116114.png" style="width: 78px;"></a><br>本服务由易嵌联授权提供</p></div>',replace:!0}}]),a.directive("jftcopyright",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'==uuid" class="link-phone" ng-click ="login()">{{userData.loginTitle}} <span ng-bind="userData.loginOut"></span> | </a><a ng-if="\'\'!=uuid"><span>您已登录</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a>｜<a ng-click="showRechargeDesc()">充值说明</a></p><p class="logo"><a href="http://eqxiu.com/s/6swATl6d" target="_blank"><img src="http://pic.ofcard.com/cards/mobile/img/ofcard-logo-jft.png" style="width: 78px;"></a><br>本服务由易嵌联授权提供</p></div>',replace:!0}}]),a.directive("vmallcopyright",["$rootScope",function(e){return{restrict:"E",template:'<div class="copyright"><p class="link"><a ng-if="\'\'==uuid" class="link-phone" ng-click ="login()">{{userData.loginTitle}} <span ng-bind="userData.loginOut"></span> | </a><a ng-if="\'\'!=uuid"><span>您已登录</span> | </a><a ui-sref="order-query({type:\'remote\'})">订单查询</a>｜<a ng-click="showRechargeDesc()">充值说明</a></p><p class="logo"><a target="_blank" href="http://m.vmall.com"><img src="http://pic.ofcard.com/cards/mobile/img/hw-logo.png" style="  width: 90px;height: 25px;"></a> | <a href="http://eqxiu.com/s/6swATl6d" target="_blank"><img src="http://pic.ofcard.com/cards/mobile/img/ofcard-logo.png" style="width: 78px;"><br>欧飞提供技术支持</p></div>',replace:!0}}])}),define("directive/mobile/standard/main-directive-mobile",["angular","./common/common-directive"],function(e){e.module("openwebApp.directives",["openwebApp.directive.common.commonModule"])}),define("filter/main-filter",["angular"],function(e){var a=e.module("openwebApp.filters",[]);a.factory("UserInterceptor",["$q","$rootScope",function(e,a){return{request:function(e){e.url;return e},responseError:function(o){o.config;return("403"==o.status||"403"==o.status)&&(a.lastForm=o.config.params,a.lastUrl=o.config.url,a.$emit("userIntercepted","notLogin",o)),e.reject(o)}}}]),a.config(["$httpProvider",function(e){e.interceptors.push("UserInterceptor")}])}),define("service/common/common-service",["angular"],function(e){var a=e.module("openwebApp.service.comm.commonModule",[]);a.factory("MenuService",["$http",function(e){return{phonerecharge:{desc:["1.月初和月末运营商系统繁忙，话费到账时间可能会出现延迟。","2.部分状态特殊的手机号(空号、停机等)造成无法充值，将会进行退款。","3.30元以上面值的部分订单会出现分批到账情况无法参加运营商的活动。"]},flowrecharge:{desc:["1.月初和月末运营商系统繁忙，话费到账时间可能会出现延迟。","2.部分状态特殊的手机号(空号、停机等)造成无法充值，将会进行退款。","3.30元以上面值的部分订单会出现分批到账情况无法参加运营商的活动。"]},gasrecharge:{desc:["1.充值成功预计1-15分钟到账；","2.如充错账号，支付资金无法返还；","3.如充值失败，退款将在2-7个工作日内退还到原支付账号；","4.充值成功后，需要到中石油、中石化加油站圈存，圈存完成后，您才可以持卡消费；"]},giftCardrecharge:{desc:["1.本站礼品卡均由官方网站购买，如需了解注意事项，请前往相应官网了解清楚后购买。","2.售出卡密为官方卡密，均不退不换，若接收短信错误导致卡密信息泄漏，由客户自行承担。","3.请认真核对接收短信地址，如长时间未接收到卡密信息请联系本站客服。"]},gamerecharge:{desc:["1.请确保您的游戏信息填写正确，部分游戏账号需填写完整格式，如邮箱形式等。","2.由于您充值账号输入错误但充值成功的，系统不予退款。","3.若长时间充值不到账，请您拨打客服电话；"]},viprecharge:{desc:["1.请确保您的会员账号信息填写正确，部分会员账号需填写完整格式，如邮箱形式等。","2.由于您充值账号输入错误但充值成功的，系统不予退款。","3.若长时间充值不到账，请您拨打客服电话；"]},publicrecharge:{desc:["1.充值不到账或退款问题请微信关注欧飞便民生活资讯或拨打客服电话：025-69828599"]},web:{parentMenu:[{name:"充值中心"}],rcMenu:[{pathname:"phonerecharge",value:{name:"手机充值",url:"phonerecharge",iconClass:"iconMobile",pic:"pay",title:"让缴费充值更轻松！",descTitle:"服务说明",cateUrl:"/webCate?menu=phonerecharge",desc:["1.月初和月末运营商系统繁忙，话费到账时间可能会出现延迟。","2.部分状态特殊的手机号(空号、停机等)造成无法充值，将会进行退款。","3.30元以上面值的部分订单会出现分批到账情况,无法参加运营商的活动。"]},webPayList:{}},{pathname:"gamerecharge",value:{name:"游戏直充",url:"gamerecharge",iconClass:"iconGame",pic:"pay",title:"让缴费充值更轻松！",descTitle:"服务说明",cateUrl:"/webCate?menu=gamerecharge",desc:["1.请确保您的游戏信息填写正确，部分游戏账号需填写完整格式，如邮箱形式等。","2.由于您充值账号输入错误但充值成功的，系统不予退款。","3.	若长时间充值不到账，请您拨打客服电话。"]}},{pathname:"publicrecharge",value:{name:"生活缴费",url:"publicrecharge",iconClass:"iconLife",pic:"pay",title:"让缴费充值更轻松！",descTitle:"服务说明",cateUrl:"/webCate?menu=publicrecharge",desc:["1.请您确保正确填写账单信息，对于因您提供信息不真实或不完整所造成的损失由您自行承担。","2.填写账单信息后点击【显示账单】，如果没有出账单会提示，如果查出账单可直接进行缴费。","3.因您提供的账单逾期或支付资金不足等任何原因导致账单支付不成功的，我司将返回失败信息，因此导致逾期时间增长或任何其他损失的，请自行完全承担。"]}},{pathname:"gasrecharge",value:{name:"加油卡直充",url:"gasrecharge",iconClass:"icon-oil",pic:"pay",title:"让缴费充值更轻松！",descTitle:"服务说明",cateUrl:"/webCate?menu=gasrecharge",desc:["1.请仔细核对加油卡号并确认，充错卡号无法退款。","2.固定面值加油卡充值不提供发票，敬请谅解；如需发票，请选择任意充充值方式。","3.充值成功后，需到加油站进行圈存操作，否则充值金额将无法生效。","4.普通发票加油卡：充值成功24小时后（部分省市48小时后），您可携带加油卡主卡至发卡地市的任一售卡充值网点补开普通发票。增值税发票加油卡可进行固定面值充值，但无法进行任意充，并不提供发票。"]}},{pathname:"giftrecharge",value:{servicePhone:"025-69828599",name:"礼品卡",url:"giftrecharge",iconClass:"iconCard",pic:"pay",title:"让缴费充值更轻松！",descTitle:"服务说明",cateUrl:"/webCate?menu=giftrecharge",desc:["1.本站礼品卡均由官方网站购买，如需了解注意事项，请前往相应官网了解清楚后购买。","2.售出卡密为官方卡密，均不退不换，若接收短信错误导致卡密信息泄漏，由客户自行承担。","3.请认真核对接收短信地址，如长时间未接收到卡密信息请联系本站客服。"]}},{pathname:"phoneCardrecharge",value:{servicePhone:"025-69828599",name:"话费卡密",url:"phoneCard",iconClass:"icon-mobile",pic:"pay",title:"让缴费充值更轻松！",descTitle:"服务说明",cateUrl:"/webCate?menu=phoneCard",desc:["1.本服务不存在兼职，刷单等行为，谨慎保管个人信息及充值卡密码，请勿上当受骗，请在卡密有效期内使用！逾期将视 为放弃卡余额。","2.移动卡充值方式为：拨打13800138000使用18位密码充值卡充值，联通卡充值方式：为拨打10011使用19位密码充值卡充值，电信卡充值方式为：拨打11888，按语音提示操作。","3.请您看清说明后再行购买，请勿屯卡，即买即用，有问题及时联系客服，不受理除密码错误以外的其他查询，如需查询其他信息请致电当地运营商。"]}},{pathname:"gameCardrecharge",value:{servicePhone:"025-69828599",name:"游戏卡密",url:"gameCard",iconClass:"icon-game",pic:"pay",title:"让缴费充值更轻松！",descTitle:"服务说明",cateUrl:"/webCate?menu=gameCard",desc:["1.本站不存在兼职，刷单等行为，请勿上当受骗，请在卡密有效期内使用！逾期将视 为放弃卡余额。","2.本站游戏卡密均由官方网站购买，如需了解注意事项，请前往相应官网了解清楚后购买。","3.售出卡密为官方卡密，均不退不换，若接收短信手机错误导致卡密信息泄漏，由客户自行承担。","4.请认真核对接收短信地址，如长时间未接受到卡密信息请联系本站客服。"]}},{pathname:"tencent",value:{servicePhone:"025-69828599",name:"腾讯游戏直充",url:"tencentrecharge",iconClass:"iconQQ",pic:"pay",title:"让缴费充值更轻松！",descTitle:"服务说明",cateUrl:"/webCate?menu=tencentrecharge",desc:["1.请确保您的游戏信息填写正确，部分游戏账号需填写完整格式，如邮箱形式等。","2.由于您充值账号输入错误但充值成功的，系统不予退款。","3.	若长时间充值不到账，请您拨打客服电话。"]}}],perMenu:[{name:"账户信息",url:"userinfo"}]}}}]),a.factory("dialog",["$ionicPopup","$ionicLoading","$rootScope",function(a,o,r){return{showTip:function(a){return a=e.extend({template:'<i class="icon ion-loading-c icon-refreshing"></i><br>努力加载中',noBackdrop:!0,delay:!1,duration:2e3},a),o.show(a)},hideTip:function(){o.hide()},confirm:function(o){return o=e.extend({title:"",content:"",cancelText:"确定",okText:"取消",cancelType:"button-positive",okType:"button-default"},o),a.confirm(o)}}}]),a.factory("RequestUtil",["$http","$timeout","$rootScope","$state","dialog",function(e,a,o,r,t){return{request:function(o,r,c,i){var s=!1;return Tools.prototype.isEmpty(i)||(s=!0),s&&t.showTip({template:i,duration:!1}),e.get(o,{params:r}).success(function(e){s&&t.hideTip(),c.call(this,e)}).error(function(){t.hideTip()})["finally"](function(){s&&a(function(){t.hideTip()},6e3)})}}}]),a.factory("CommonService",["$http","$timeout","$state","dialog","$rootScope","RequestUtil",function(e,a,o,r,t,c){return{getFaceValueList:[{id:"",value:10,disprice:"10~11",stock:!0,choosed:!1,productName:""},{id:"",value:20,disprice:"20~21",stock:!0,choosed:!1,productName:""},{id:"",value:30,disprice:"30~31",stock:!0,choosed:!1,productName:""},{id:"",value:50,disprice:"49.65~49.9",stock:!0,choosed:!1,productName:""},{id:"",value:100,disprice:"99.3~99.9",stock:!0,choosed:!0,productName:""},{id:"",value:200,disprice:"197~199",stock:!0,choosed:!1,productName:""},{id:"",value:300,disprice:"295~299",stock:!0,choosed:!1,productName:""},{id:"",value:500,disprice:"493~499",stock:!0,choosed:!1,productName:""}],getBankList:{dCards:[{bankName:"交通银行",bankIcon:"bankcomm",bankCode:"0106",bankTypeId:1,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"},{bankName:"中国光大银行",bankIcon:"cebbank",bankCode:"0108",bankTypeId:1,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"},{bankName:"广发银行",bankIcon:"gdb",bankCode:"0109",bankTypeId:1,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"},{bankName:"中国民生银行",bankIcon:"cmbc",bankCode:"0110",bankTypeId:1,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"},{bankName:"兴业银行",bankIcon:"cib",bankCode:"0107",bankTypeId:1,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"},{bankName:"中信银行",bankIcon:"ecitic",bankCode:"0111",bankTypeId:1,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"},{bankName:"浦发银行",bankIcon:"spdb",bankCode:"0112",bankTypeId:1,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"}],cCards:[{bankName:"交通银行",bankIcon:"bankcomm",bankCode:"0206",bankTypeId:2,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"},{bankName:"中国光大银行",bankIcon:"cebbank",bankCode:"0208",bankTypeId:2,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"},{bankName:"广发银行",bankIcon:"gdb",bankCode:"0209",bankTypeId:2,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"},{bankName:"中国民生银行",bankIcon:"cmbc",bankCode:"0210",bankTypeId:2,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"},{bankName:"兴业银行",bankIcon:"cib",bankCode:"0207",bankTypeId:2,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"},{bankName:"中信银行",bankIcon:"ecitic",bankCode:"0211",bankTypeId:2,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"},{bankName:"浦发银行",bankIcon:"spdb",bankCode:"0212",bankTypeId:2,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"}]},getBankListForMobile:{dCards:[{bankName:"中国银行",bankIcon:"icbc",bankCode:"0803",bankTypeId:1,payTypeId:"OLP",payTypeName:"在线支付",rate:"2"}]},getHotGameList:[{vid:"v2331",name:"Q币直充",logo:"http://pic.ofcard.com/cards/images/game01.jpg","class":"game-01"},{vid:"v1188",name:"魔兽世界",logo:"http://pic.ofcard.com/cards/images/game02.jpg","class":"game-02"},{vid:"v1343",name:"英雄联盟",logo:"http://pic.ofcard.com/cards/images/game03.jpg","class":"game-03"},{vid:"v1317",name:"地下城与勇士",logo:"http://pic.ofcard.com/cards/images/game04.jpg","class":"game-04"},{vid:"v1341",name:"穿越火线",logo:"http://pic.ofcard.com/cards/images/game05.jpg","class":"game-05"},{vid:"v1462",name:"天龙八部3",logo:"http://pic.ofcard.com/cards/images/game06.jpg","class":"game-06"},{vid:"v1393",name:"剑网3",logo:"http://pic.ofcard.com/cards/images/game07.jpg","class":"game-07"}],getLettersList:[{name:"热门",choosed:!0},{name:"A",choosed:!1},{name:"B",choosed:!1},{name:"C",choosed:!1},{name:"D",choosed:!1},{name:"E",choosed:!1},{name:"F",choosed:!1},{name:"G",choosed:!1},{name:"H",choosed:!1},{name:"I",choosed:!1},{name:"J",choosed:!1},{name:"K",choosed:!1},{name:"L",choosed:!1},{name:"M",choosed:!1},{name:"N",choosed:!1},{name:"O",choosed:!1},{name:"P",choosed:!1},{name:"Q",choosed:!1},{name:"R",choosed:!1},{name:"S",choosed:!1},{name:"T",choosed:!1},{name:"U",choosed:!1},{name:"V",choosed:!1},{name:"W",choosed:!1},{name:"X",choosed:!1},{name:"Y",choosed:!1},{name:"Z",choosed:!1}],getGasCardList:[{id:"35212",name:"全国中石化加油卡直充",pic:"http://pic.ofcard.com/cards/images/card20.jpg",wapPic:"oil-cc",url:"gasRecharge"}],getGiftCardList:[{id:"2639602",name:"唯品会礼品卡"},{id:"2364419",name:"苏宁礼品卡"},{id:"2304155",name:"携程礼品卡"},{id:"2264866",name:"亚马逊礼品卡"},{id:"2184389",name:"1号店礼品卡"},{id:"2185598",name:"国美红券"},{id:"2185429",name:"当当礼品卡"},{id:"2451724",name:"京东E卡"},{id:"3509802",name:"天猫超市卡"}],getGiftCardListForB2C:[{id:"2639602",name:"唯品会礼品卡"},{id:"2364419",name:"苏宁礼品卡"},{id:"2304155",name:"携程礼品卡任我游"},{id:"2303881",name:"携程礼品卡任我行"},{id:"2264866",name:"亚马逊礼品"},{id:"2184389",name:"1号店礼品卡"},{id:"2185598",name:"国美红券"},{id:"2639596",name:"中粮我买卡"},{id:"2185429",name:"当当礼品卡"},{id:"3509802",name:"天猫超市卡"}]}}]),a.factory("MessageService",function(){return{errorMsg:{commonMsg:{order_limit:"订单超额",no_face_value:"请选择面值",no_stock:"抱歉，暂时缺货，请重新选择",no_phone:"请输入手机号",phone_format_error:"手机号码格式错误",no_code:"请输入短信验证码",no_image_code:"请输入验证字符",check_image_code_error:"验证字符错误，请重新输入",send_code_error:"获取验证码错误，请稍后重试",over_sending_limit:"操作过于频繁，请稍后再试",check_code_error:"验证码验证错误，请重新获取",pay_error:"抱歉,支付异常,请稍后重试",query_order_error:"抱歉，未查询到相关订单",no_oilNo:"请输入加油卡号",query_gascard_error:"加油卡信息错误",oilNO_format_error:"加油卡号格式错误",cardNum_format_error:"请正确输入购买数量",no_product:"商品维护",no_charge_amount:"请输入充值金额",wrong_charge_amount:"充值金额错误",prompt_agreetment_check:"请阅读并勾选同意加油卡充值协议",no_card_num:"请输入购买数量",card_num_error:"购买数量范围错误,请重新输入",no_battle_account:"请输入通行证账号",battle_account_format_error:"通行证账号格式不正确,请输入邮箱",no_game_account:"请输入游戏账号",no_vip_account:"请输入会员账号",no_game_area:"请输入游戏大区",no_game_service:"请输入游戏服",no_publicNo:"请输入户号",no_publicUnit:"请选择单位",wrong_publicNo:"未查询到账单信息",wrong_cash:"欠费金额有问题"},changeCardMsg:{no_face_value:"请选择面额",no_card_type:"请选择充值卡类型",no_card_no:"请输入充值卡卡号",no_card_pass:"请输入充值卡卡密",card_no_format_error:"卡号格式错误",card_pass_format_error:"密码格式错误",no_stock:"抱歉!库存不足,请选择其他面额",card_error:"充值卡卡号或卡密错误,请核实",card_used:"此充值卡已兑换,请重输卡号卡密",no_agree:"请接受服务条款",take_order_error_system:"系统异常,请稍后重试或联系客服",take_order_error_card_info:"充值卡信息不存在,请重新输入",take_order_error_card_used:"充值卡已使用,请重新输入",take_order_error:"抱歉,提交失败!请更换卡密或联系客服",query_order_error:"抱歉，未查询到相关订单",query_card_error:"抱歉,提取卡密失败,请重试"},phoneRechargeMsg:{phone_no_format_error:"号码格式错误",phone_no_support_error:"暂不支持此号码充值",phone_no_error:"未知号码",no_stock:"库存不足,请重新选择面额!",no_phone_no:"请输入充值号码",no_face_value:"请选择面额"},giftCardMsg:{no_face_value:"请选择面额",no_shortMsg_or_email:"请输入短信接收号码",no_stock:"抱歉!库存不足,请选择其他面额",shortMsg_format_error:"短信号码格式错误",cardNum_format_error:"请正确输入购买数量",send_code_error:"获取验证码错误，请稍后重试",check_code_error:"验证码验证错误，请重新获取",no_code_error:"请填写验证码",query_card_error:"抱歉,提取卡密失败,请重试"},payMsg:{pay_amount_error:"手续费读取失败，请刷新页面或重新选择银行"},searchMsg:{no_account:"请输入充值账号"},gameMsg:{no_face_value:"请选择面值",no_battle_account:"请输 入通行证账号",no_game_count:"请输入游戏账号",no_game_area:"请选择游戏区",no_game_server:"请选择游戏服务器",battle_account_format_error:"通行证账号格式不正确,请输入邮箱",no_game_product:"游戏维护，暂不能充值，请稍后重试。",no_game_product_stock:"库存不足，请选择其他面值。",no_card_num:"请正确输入购买数量",no_choose_card_num:"请选择购买数量"},publicMsg:{no_province:"请选择所在省",no_city:"请选择所在市",no_pay_project:"请选择缴费项目",no_pay_unit:"请选择缴费单位",no_pebarCd:"请输入户号",no_stock:"抱歉，该地区暂不支持缴费",no_owed:"您未欠费,暂不支持预缴费",no_bill:"抱歉，未查询到账单信息"},gasMsg:{no_gas_product:"商品维护,请稍后重试",no_face_value:"请选择面额",no_shortMsg_or_email:"请输入短信接收号码",no_stock:"抱歉!库存不足,请选择其他面额",shortMsg_format_error:"短信号码格式错误",cardNum_format_error:"请正确输入购买数量",send_code_error:"获取验证码错误，请稍后重试",check_code_error:"验证码验证错误，请重新获取",no_code_error:"请填写验证码",query_card_error:"抱歉,提取卡密失败,请重试",no_oilNO:"请输入加油卡卡号",oilNO_format_error:"加油卡卡号格式错误",query_gascard_error:"抱歉,未查询到加油卡信息",no_gascard_info:"请查询加油卡信息",tel_format_error:"手机号码格式错误",no_tel:"请输入持卡人手机号",no_gas_name:"请输入持卡人姓名",no_gas_card_num:"请输入购买金额",cal_service_fee_failed:"获取总价错误"},marketMsg:{no_mobileNo:"请输入手机号",mobileNo_format_error:"抱歉,手机号格式不正确",sys_error:"抱歉,系统繁忙,请稍后重试",has_bill:"抱歉,您已领取红包",mobileNo_error:"抱歉,未知手机号,请重新输入",mobileNo_info_error:"抱歉,手机号受限,请查看说明",no_cdKey:"请输入兑换码",browser_error:"请在微信客户端中分享",error_facevalue:"抱歉，该优惠劵面值低于实际充值面值"},orderMsg:{phone_no_error:"暂不支持此格式号码充值",no_oil_no:"请输入加油卡卡号",oil_no_format_error:"加油卡卡号格式错误",query_order_error:"抱歉，未查询到相关订单"}},menuDesc:{payDesc:["1.本站所售均为低利润的数字化产品，商品价格未包含银行支付收取的手续费。","2.手续费由相应提供支付的银行收取，如发生退款，支付手续费不退回。","3.付款成功之后若订单状态未改变请耐心等待，若长时间未改版请联系客服。"]}}})}),define("service/standard/gavin-service",["angular"],function(e){var a=e.module("openwebApp.service.gavin.gavinModule",[]);a.factory("GavinService",["$http","$state","$rootScope","RequestUtil",function(e,a,o,r){return{sendVerifyCode:function(a,o){e.get("/gavin/sendVerifyCode",{params:a}).success(o)},checkVerifyCode:function(a,o){e.get("/gavin/checkVerifyCode",{params:a}).success(o)}}}])}),define("service/standard/product-service",["angular"],function(e){var a=e.module("openwebApp.service.product.productModule",[]);a.factory("ProductService",["$http","$state","$rootScope","RequestUtil",function(e,a,o,r){return{getFaceValue:function(e,a){return r.request("/product/faceValueList",{itemClassId:e},a,"正在查询")},getPhoneFaceValue:function(e,a){return r.request("/product/getPhoneFaceValue",e,a,"正在查询")},getPhoneProduct:function(e,a){return r.request("/product/getPhoneProduct",e,a,"正在查询")},getWebPhoneProduct:function(e,a){
return r.request("/product/getPhoneProduct",e,a,"")},checkCanOrder:function(e,a){return r.request("/product/checkCanOrder",e,a,"")},getSalePrice:function(e,a){return r.request("/product/getSalePrice",e,a,"")},getGameList:function(e){return r.request("/product/getGameList",null,e,"正在查询")},getWebGameList:function(e){return r.request("/product/getGameList",null,e,"")},getGameInfo:function(e,a){return r.request("/product/getGameInfo",e,a,"正在查询")},getVipList:function(e){return r.request("/product/getVipList",null,e,"正在查询")},getWebGameInfo:function(e,a){return r.request("/product/getGameInfo",e,a,"")},getVipInfo:function(e,a){return r.request("/product/getVipInfo",e,a,"正在查询")},getVipCardStock:function(e,a){return r.request("/product/getVipCardStock",e,a,"")},getGameArea:function(e,a){return r.request("/product/getGameAreas",e,a,"")},getGameServer:function(e,a){return r.request("/product/getGameServices",e,a,"")},getGiftCardList:function(e){return r.request("/product/getGiftCardList",null,e,"正在查询")},getGiftCardInfo:function(e,a){return r.request("/product/getGiftCardInfo",e,a,"")},getGiftCardStock:function(e,a){return r.request("/product/getGiftCardStock",e,a,"")},getProvinceList:function(e,a){return r.request("/product/queryProvinceList",null,a,"正在查询")},getCityList:function(e,a){return r.request("/product/queryCityList",e,a,"正在查询")},getWebProvinceList:function(e,a){return r.request("/product/queryProvinceList",null,a,"")},getWebCityList:function(e,a){return r.request("/product/queryCityList",e,a,"")},getPayProjectList:function(e,a){return r.request("/product/queryPayProjectList",e,a,"正在查询")},getWebPayProjectList:function(e,a){return r.request("/product/queryPayProjectList",e,a,"")},getPayUnitList:function(e,a){return r.request("/product/queryPayUnitList",e,a,"正在查询")},getWebPayUnitList:function(e,a){return r.request("/product/queryPayUnitList",e,a,"")},getArrearsInfos:function(e,a){return r.request("/product/queryArrearsInfos",e,a,"正在查询")},getWebArrearsInfos:function(e,a){return r.request("/product/queryArrearsInfos",e,a,"")},getPhoneInfo:function(e,a){return r.request("/product/getPhoneInfo",{phoneNo:e},a,"")},calServiceFee:function(e,a,o,t){return r.request("/product/calServiceFee",{saleAmount:e,opt:a,expression:o},t,"")},getGasCardInfo:function(e,a){return r.request("/product/getGasInfo",e,a,"正在查询")},getWebGasCardInfo:function(e,a){return r.request("/product/getGasInfo",e,a,"")},getFlowSalePrice:function(e,a){return r.request("/product/getFlowSalePrice",e,a,"")},getGasCardProductInfo:function(e,a){return r.request("/product/getGasCardProductInfo",{gasRechargeType:e},a,"")},getPublicCity:function(e,a){return r.request("/product/getPublicCity",e,a,"正在查询")},getPublicArea:function(e,a){return r.request("/product/getPublicArea",e,a,"正在查询")},queryPublicInfo:function(e,a){return r.request("/product/queryPublicInfo",e,a,"正在查询")},queryWebPublicInfo:function(e,a){return r.request("/product/queryPublicPayProduct",e,a,"")},queryAreaByIp:function(e){return r.request("/product/queryAreaByIp",null,e,"正在查询")},getPhoneFaceValueList:[{id:"",value:"10",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"30",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"50",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"100",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"200",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"500",stock:!1,choosed:!1,boardId:"",price:""}],getABCPhoneFaceValueList:[{id:"",value:"10",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"20",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"30",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"50",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"100",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"200",stock:!1,choosed:!1,boardId:"",price:""}],getPSBCPhoneFaceValueList:[{id:"",value:"10",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"20",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"50",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"100",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"200",stock:!1,choosed:!1,boardId:"",price:""},{id:"",value:"500",stock:!1,choosed:!1,boardId:"",price:""}],getYCPSBCPhoneFaceValueList:[{id:"",value:"5",stock:!1,choosed:!1,boardId:"",price:""}],getFlowFaceValue:[{id:"",flowValue:"10M",stock:!1,choosed:!1},{id:"",flowValue:"20M",stock:!1,choosed:!1},{id:"",flowValue:"50M",stock:!1,choosed:!1},{id:"",flowValue:"100M",stock:!1,choosed:!1},{id:"",flowValue:"200M",stock:!1,choosed:!1},{id:"",flowValue:"500M",stock:!1,choosed:!1}],getFaceValueForCM:[{id:"",perValue:3,flowValue:"10M",stock:!1,choosed:!1,price:""},{id:"",perValue:5,flowValue:"30M",stock:!1,choosed:!1,price:""},{id:"",perValue:10,flowValue:"70M",stock:!1,choosed:!1,price:""},{id:"",perValue:20,flowValue:"150M",stock:!1,choosed:!1,price:""},{id:"",perValue:30,flowValue:"500M",stock:!1,choosed:!1,price:""},{id:"",perValue:50,flowValue:"1G",stock:!1,choosed:!1,price:""}],getFaceValueForCU:[{id:"",perValue:3,flowValue:"20M",stock:!1,choosed:!1,price:""},{id:"",perValue:6,flowValue:"50M",stock:!1,choosed:!1,price:""},{id:"",perValue:10,flowValue:"100M",stock:!1,choosed:!1,price:""},{id:"",perValue:15,flowValue:"200M",stock:!1,choosed:!1,price:""},{id:"",perValue:30,flowValue:"500M",stock:!1,choosed:!1,price:""},{id:"",perValue:100,flowValue:"1G",stock:!1,choosed:!1,price:""}],getFaceValueForCT:[{id:"",perValue:2,flowValue:"10M",stock:!1,choosed:!1,price:""},{id:"",perValue:5,flowValue:"30M",stock:!1,choosed:!1,price:""},{id:"",perValue:7,flowValue:"50M",stock:!1,choosed:!1,price:""},{id:"",perValue:10,flowValue:"100M",stock:!1,choosed:!1,price:""},{id:"",perValue:30,flowValue:"500M",stock:!1,choosed:!1,price:""},{id:"",perValue:50,flowValue:"1G",stock:!1,choosed:!1,price:""}],getFaceValueForGasRecharge:[{productCode:"",faceValue:100,productName:"100元",choosed:!1,stock:!1,isOneFaceValue:!1},{productCode:"",faceValue:200,productName:"200元",choosed:!1,stock:!1,isOneFaceValue:!1},{productCode:"",faceValue:500,productName:"500元",choosed:!1,stock:!1,isOneFaceValue:!1},{productCode:"",faceValue:1e3,productName:"1000元",choosed:!1,stock:!1,isOneFaceValue:!1},{productCode:"",faceValue:5e3,productName:"5000元",choosed:!1,stock:!1,isOneFaceValue:!1},{productCode:"",faceValue:1,productName:"",choosed:!1,stock:!1,isOneFaceValue:!0}],getFaceValueForWebGasRecharge:[{productCode:"",faceValue:50,productName:"50元",choosed:!1,stock:!1,isOneFaceValue:!1,vName:"50元",price:"",salePrice:"",purNum:""},{productCode:"",faceValue:100,productName:"100元",choosed:!1,stock:!1,isOneFaceValue:!1,vName:"100元",price:"",salePrice:"",purNum:""},{productCode:"",faceValue:500,productName:"500元",choosed:!1,stock:!1,isOneFaceValue:!1,vName:"500元",price:"",salePrice:"",purNum:""},{productCode:"",faceValue:1e3,productName:"1000元",choosed:!1,stock:!1,isOneFaceValue:!1,vName:"1000元",price:"",salePrice:"",purNum:""},{productCode:"",faceValue:5e3,productName:"5000元",choosed:!1,stock:!1,isOneFaceValue:!1,vName:"5000元",price:"",salePrice:"",purNum:""}],getFaceValueForWebOneGasRecharge:[{productCode:"",faceValue:1,productName:"",choosed:!1,stock:!1,isOneFaceValue:!0,vName:"任意充",price:"",salePrice:"",purNum:""}],chargeGameInfo:{},chargeGiftCardInfo:{},chargeVipInfo:{},getLettersList:[{name:"A",choosed:!1},{name:"B",choosed:!1},{name:"C",choosed:!1},{name:"D",choosed:!1},{name:"E",choosed:!1},{name:"F",choosed:!1},{name:"G",choosed:!1},{name:"H",choosed:!1},{name:"I",choosed:!1},{name:"J",choosed:!1},{name:"K",choosed:!1},{name:"L",choosed:!1},{name:"M",choosed:!1},{name:"N",choosed:!1},{name:"O",choosed:!1},{name:"P",choosed:!1},{name:"Q",choosed:!1},{name:"R",choosed:!1},{name:"S",choosed:!1},{name:"T",choosed:!1},{name:"U",choosed:!1},{name:"V",choosed:!1},{name:"W",choosed:!1},{name:"X",choosed:!1},{name:"Y",choosed:!1},{name:"Z",choosed:!1}]}}])}),define("service/standard/order-service",["angular"],function(e){var a=e.module("openwebApp.service.order.orderModule",[]);a.factory("OrderService",["$http","$state","$rootScope","RequestUtil",function(e,a,o,r){var t=function(){return Math.random().toString(36).substr(2)};return{takeSaleOrderNew:function(e,a){return r.request("/order/takeSaleOrderNew?randomId="+t(),e,a,"正在提交")},takeSaleOrder:function(e,a){return r.request("/order/takeSaleOrder?randomId="+t(),e,a,"正在提交")},takeWebSaleOrder:function(e,a){return r.request("/web/takeSaleOrder?randomId="+t(),e,a,"")},queryOrderDetail:function(e,a){return r.request("/order/queryOrderDetail?randomId="+t(),e,a,"")},queryOrderInfo:function(e,a){return r.request("/order/queryOrderInfo?randomId="+t(),e,a,"正在查询")},queryOrders:function(e,a){return r.request("/order/queryOrderInfos?randomId="+t(),e,a,"正在查询")},takeSaleOrderAndPay:function(e,a){return r.request("/order/takeSaleOrderAndPay?randomId="+t(),e,a,"正在提交")},orderList:function(e,a){return r.request("/order/orderList?randomId="+t(),e,a,"正在查询")}}}])}),define("service/standard/pay-service",["angular"],function(e){var a=e.module("openwebApp.service.pay.payModule",[]);a.factory("PayService",["$http","$state","$rootScope","RequestUtil",function(e,a,o,r){var t=function(){return Math.random().toString(36).substr(2)};return{getPayUrlForMobile:function(e,a){return r.request("/pay/checkIsSwitchNewGate?randomId="+t(),e,a,"正在提交")},getPayUrl:function(e,a){return r.request("/web/getPayUrl?randomId="+t(),e,a,"正在提交")}}}])}),define("service/standard/market-service",["angular"],function(e){var a=e.module("openwebApp.service.market.marketModule",[]);a.factory("MarketService",["$http","$state","$rootScope","RequestUtil",function(e,a,o,r){return{getPrizes:[{id:"P00006",name:"华为优购码",pic:"http://pic.ofcard.com/cards/standard/img/lottery-gift01.png",index:0,icon:""},{id:"P00010",name:"7元抵用券",pic:"http://pic.ofcard.com/cards/standard/img/lottery-gift-liuliang.png",index:1,icon:"lottery-gift02"},{id:"P00001",name:"韩束补水面膜",pic:"http://pic.ofcard.com/cards/standard/img/lottery-gift01.png",index:2,icon:""},{id:"P00007",name:"1元抵用券",pic:"http://pic.ofcard.com/cards/standard/img/lottery-gift-liuliang.png",index:9,icon:"lottery-gift02"},{id:"P00002",name:"京东E卡100元",pic:"http://pic.ofcard.com/cards/standard/img/lottery-gift01.png",index:3,icon:""},{id:"P00004",name:"京东E卡200元",pic:"http://pic.ofcard.com/cards/standard/img/lottery-gift01.png",index:8,icon:""},{id:"P00009",name:"4元抵用券",pic:"http://pic.ofcard.com/cards/standard/img/lottery-gift-liuliang.png",index:4,icon:"lottery-gift02"},{id:"P00005",name:"海鲜大礼包",pic:"http://pic.ofcard.com/cards/standard/img/lottery-gift01.png",index:7,icon:""},{id:"P00008",name:"2元抵用券",pic:"http://pic.ofcard.com/cards/standard/img/lottery-gift-liuliang.png",index:6,icon:"lottery-gift02"},{id:"P00003",name:"韩束BB霜",pic:"http://pic.ofcard.com/cards/standard/img/lottery-gift01.png",index:5,icon:""}],getPrize:function(a,o){e.get("/market/getPrize",{params:a}).success(o)},getPrizeOrder:function(a,o){e.get("/market/getPrizeOrder",{params:a}).success(o)},getMarketBills:function(e,a){return r.request("/market/queryBill",e,a,"正在查询")},getMarketBillByCDKey:function(e,a){return r.request("/market/queryBillByCDKey",e,a,"正在查询")},bindMarketBill:function(a,o){e.get("/market/bindBill",{params:a}).success(o)}}}])}),define("service/standard/member-service",["angular"],function(e){var a=e.module("openwebApp.service.member.memberModule",[]);a.factory("MemberService",["$http","$state","$rootScope","RequestUtil",function(e,a,o,r){return{login:function(a,o){e.get("/member/login",{params:a}).success(o)},updateUserInfo:function(a,o){e.get("/member/updateuser",{params:a}).success(o)},getCasheUserInfo:function(a,o){e.get("/member/getcacheuserinfo",{params:a}).success(o)}}}])}),define("service/addons/mobile/standard/main-service-mobile",["angular","../../../common/common-service","../../../standard/gavin-service","../../../standard/product-service","../../../standard/order-service","../../../standard/pay-service","../../../standard/market-service","../../../standard/member-service"],function(e){e.module("openwebApp.services",["openwebApp.service.comm.commonModule","openwebApp.service.gavin.gavinModule","openwebApp.service.product.productModule","openwebApp.service.order.orderModule","openwebApp.service.pay.payModule","openwebApp.service.market.marketModule","openwebApp.service.member.memberModule"])}),define("routes/mobile/standard/common/common-routes",["angular"],function(e){var a=e.module("openwebApp.route.common.commonModule",[]);a.config(["$stateProvider",function(e){e.state("recharge-desc",{url:"/recharge-desc",templateUrl:"/partials/mobile/standard/common/recharge-desc.html",controller:"RechargeDescCtrl"}),e.state("order-query",{url:"/order-query?type",templateUrl:"/partials/mobile/standard/order/order-query.html",controller:"OrderQueryCtrl"}),e.state("login",{url:"/login",templateUrl:"/partials/mobile/standard/common/login-index.html",controller:"LoginCtrl"}),e.state("market",{url:"/market?category",templateUrl:"/partials/mobile/standard/common/market-index.html",controller:"MarketCtrl"})}])}),define("routes/mobile/standard/category/phone-routes",["angular"],function(e){var a=e.module("openwebApp.route.phone.phoneModule",[]);a.config(["$stateProvider",function(e){e.state("phonerecharge",{url:"/phonerecharge?phoneNo",templateUrl:"/partials/mobile/standard/phone/phone-index.html",controller:"PhoneRechargeCtrl"})}])}),define("routes/mobile/standard/category/flow-routes",["angular"],function(e){var a=e.module("openwebApp.route.flow.flowModule",[]);a.config(["$stateProvider",function(e){e.state("flowrecharge",{url:"/flowrecharge?phoneNo",templateUrl:"/partials/mobile/standard/flow/flow-index.html",controller:"FlowRechargeCtrl"})}])}),define("routes/mobile/standard/category/gas-routes",["angular"],function(e){var a=e.module("openwebApp.route.gas.gasModule",[]);a.config(["$stateProvider",function(e){e.state("gasrecharge",{url:"/gasrecharge",templateUrl:"/partials/mobile/standard/gas/gas-index.html",controller:"GasRechargeCtrl"}),e.state("agreement",{url:"/agreement",templateUrl:"/partials/mobile/standard/gas/agreement.html",controller:"GasRechargeCtrl"})}])}),define("routes/mobile/standard/category/game-routes",["angular"],function(e){var a=e.module("openwebApp.route.game.gameModule",[]);a.config(["$stateProvider",function(e){e.state("gamerecharge",{url:"/gamerecharge",templateUrl:"/partials/mobile/standard/game/game-index.html",controller:"GameIndexCtrl"}),e.state("gamelist",{url:"/gamelist",templateUrl:"/partials/mobile/standard/game/game-list.html",controller:"GameListCtrl"}),e.state("gamecharge",{url:"/gamecharge?gamename",templateUrl:"/partials/mobile/standard/game/game-recharge.html",controller:"GameRechargeCtrl"})}])}),define("routes/mobile/standard/category/gift-routes",["angular"],function(e){var a=e.module("openwebApp.route.giftCard.giftCardModule",[]);a.config(["$stateProvider",function(e){e.state("giftCardrecharge",{url:"/giftCardrecharge",templateUrl:"/partials/mobile/standard/giftCard/giftCard-index.html",controller:"GiftCardIndexCtrl"}),e.state("giftCardlist",{url:"/giftCardlist",templateUrl:"/partials/mobile/standard/giftCard/giftCard-list.html",controller:"GiftCardListCtrl"}),e.state("giftCardcharge",{url:"/giftCardcharge?giftCardName",templateUrl:"/partials/mobile/standard/giftCard/giftCard-recharge.html",controller:"GiftCardRechargeCtrl"}),e.state("instructions",{url:"/instructions",templateUrl:"/partials/mobile/standard/giftCard/instructions.html",controller:"GiftCardRechargeCtrl"})}])}),define("routes/mobile/standard/category/vip-routes",["angular"],function(e){var a=e.module("openwebApp.route.vip.vipModule",[]);a.config(["$stateProvider",function(e){e.state("viprecharge",{url:"/viprecharge",templateUrl:"/partials/mobile/standard/vip/vip-index.html",controller:"VipIndexCtrl"}),e.state("vipcharge",{url:"/vipcharge?gamename",templateUrl:"/partials/mobile/standard/vip/vip-recharge.html",controller:"VipRechargeCtrl"}),e.state("viplist",{url:"/viplist",templateUrl:"/partials/mobile/standard/vip/vip-list.html",controller:"VipListCtrl"}),e.state("vipkamicharge",{url:"/vipkamicharge?gamename",templateUrl:"/partials/mobile/standard/vip/vip-kami-recharge.html",controller:"KamiRechargeCtrl"})}])}),define("routes/mobile/standard/category/public-routes",["angular"],function(e){var a=e.module("openwebApp.route.public.publicModule",[]);a.config(["$stateProvider",function(e){e.state("publicrecharge",{url:"/publicrecharge?publicNo",templateUrl:"/partials/mobile/standard/public/public-index.html",controller:"PublicRechargeCtrl"}),e.state("publicQuery",{url:"/publicQuery?gameCount&item&projectTypeId&provNo&cityNo",templateUrl:"/partials/mobile/standard/public/public-query.html",controller:"PublicQueryCtrl"}),e.state("publicCity",{url:"/publicCity?belongTo",templateUrl:"/partials/mobile/standard/public/public-city.html",controller:"PublicCityCtrl"})}])}),define("routes/mobile/standard/main-route-mobile",["angular","./common/common-routes","./category/phone-routes","./category/flow-routes","./category/gas-routes","./category/game-routes","./category/gift-routes","./category/vip-routes","./category/public-routes"],function(e){e.module("openwebApp.routes",["openwebApp.route.common.commonModule","openwebApp.route.phone.phoneModule","openwebApp.route.flow.flowModule","openwebApp.route.gas.gasModule","openwebApp.route.game.gameModule","openwebApp.route.giftCard.giftCardModule","openwebApp.route.vip.vipModule","openwebApp.route.public.publicModule"])}),require.config({paths:{jquery:"http://pic.ofcard.com/cards/js/angular/jquery",angular:"http://pic.ofcard.com/cards/js/angular/angularmin","angular-ui-route":"http://pic.ofcard.com/cards/js/angular/angular-ui-router","angular-cookie":"http://pic.ofcard.com/cards/js/angular/angular-cookie",ionic:"http://pic.ofcard.com/cards/js/angular/ionicbundlemin",tools:"http://pic.ofpay.com/cards/js/lib/tools"},shim:{jquery:{exports:"jquery"},angular:{deps:["jquery"],exports:"angular"},"angular-ui-route":{deps:["jquery","angular"],exports:"angular-ui-router"},ionic:{exports:"ionic"},"angular-cookie":{deps:["jquery","angular"],exports:"angular-cookie"},tools:{deps:["jquery"],exports:"tools"}}}),require(["jquery","tools","angular","angular-ui-route","ionic","angular-cookie","./controller/mobile/standard/main-controller-mobile","./directive/mobile/standard/main-directive-mobile","./filter/main-filter","./service/addons/mobile/standard/main-service-mobile","./routes/mobile/standard/main-route-mobile"],function(){var module=angular.module("openwebApp",["ui.router","openwebApp.routes","openwebApp.filters","openwebApp.directives","openwebApp.services","openwebApp.controllers","ionic","ngCookies"]);module.run(["$rootScope","$state","$stateParams","$location","$cookieStore","MarketService",function($rootScope,$state,$stateParams,$location,$cookieStore,MarketService){if($rootScope.$state=$state,$rootScope.$stateParams=$stateParams,$rootScope.config=document.getElementById("config").value,$rootScope.menu=document.getElementById("menu").value,$rootScope.curRouter=$rootScope.menu,$rootScope.code=document.getElementById("code").value,$rootScope.uuid=document.getElementById("uuid")&&document.getElementById("uuid").value?document.getElementById("uuid").value:"",$rootScope.mallUrl=document.getElementById("mallUrl")&&document.getElementById("mallUrl").value?document.getElementById("mallUrl").value:"",$rootScope.mallUrlOld=document.getElementById("mallUrlOld")&&document.getElementById("mallUrlOld").value?document.getElementById("mallUrlOld").value:"",$rootScope.rechargeAccount=document.getElementById("rechargeAccount").value,$rootScope.faceValue=document.getElementById("faceValue").value,$rootScope.noRouter=document.getElementById("noRouter")&&document.getElementById("noRouter").value?document.getElementById("noRouter").value:"",$rootScope.ofLinkId=document.getElementById("ofLinkId")&&document.getElementById("ofLinkId").value?document.getElementById("ofLinkId").value:"",$rootScope.userLoginId="",$rootScope.hasUuid=!1,$rootScope.userData={},$rootScope.marketInfo={code:$rootScope.code,userId:"",faceValue:"",cash:"",title:"不使用",billId:"",category:"",marketPayType:"",getDefaultFlag:!0},$rootScope.gasCardNosForUser="",$rootScope.rechargeDesc="",!Tools.prototype.isEmpty($rootScope.config)){var config=eval("("+$rootScope.config+")");$rootScope.userData.title=config.title,$rootScope.userData.stylesheet=config.stylesheet,$rootScope.userData.payList=config.payList,$rootScope.userData.header=config.header,$rootScope.userData.returnUrl=config.returnUrl;var ua=window.navigator.userAgent.toLowerCase();angular.forEach($rootScope.userData.payList,function(e,a){"micromessenger"!=ua.match(/MicroMessenger/i)||"0820"!=e.bankCode&&"0821"!=e.bankCode?"micromessenger"!=ua.match(/MicroMessenger/i)&&"0802"==e.bankCode&&(e.bankName="支付宝支付",e.bankCode="0820",e.desc="支付宝",e.payType="AliPayMobile"):(e.bankName="微信支付",e.bankCode="0802",e.desc="微信直接支付",e.payType="Tencent"),"micromessenger"==ua.match(/MicroMessenger/i)&&"ZDY_ALIPAY_WAP"==e.bankCode?(e.bankName="微信支付",e.bankCode="ZDY_WX_JSAPI",e.desc="微信直接支付",e.payType="Tencent"):"micromessenger"!=ua.match(/MicroMessenger/i)&&"ZDY_WX_JSAPI"==e.bankCode&&(e.bankName="支付宝支付",e.bankCode="ZDY_ALIPAY_WAP",e.desc="支付宝",e.payType="AliPayMobile")}),$rootScope.userData.servicePhone=config.servicePhone,$rootScope.userData.copyright=config.copyright,$rootScope.marketInfo.category=config.marketCategory,$rootScope.marketInfo.marketPayType=config.marketPayType,Tools.prototype.isEmpty($rootScope.ofLinkId)?Tools.prototype.isEmpty(Tools.prototype.saveCookie($rootScope.code+"ofLinkId"))||($rootScope.ofLinkId=Tools.prototype.saveCookie($rootScope.code+"ofLinkId")):(Tools.prototype.saveCookie($rootScope.code+"ofLinkId",null,{path:"/"}),Tools.prototype.saveCookie($rootScope.code+"ofLinkId",$rootScope.ofLinkId,{expires:1,path:"/"})),$rootScope.loginStatus=function(){if("micromessenger"==ua.match(/MicroMessenger/i)){var e=Tools.prototype.saveCookie($rootScope.code+"hasUuid");Tools.prototype.isEmpty(e)||($rootScope.uuid=Tools.prototype.saveCookie($rootScope.code+"randomId"))}Tools.prototype.isEmpty($rootScope.uuid)?($rootScope.userLoginId=Tools.prototype.saveCookie($rootScope.code+"randomId"),Tools.prototype.isEmpty($rootScope.userLoginId)?($rootScope.userData.loginTitle="快速登录",$rootScope.userData.loginOut="",$rootScope.marketInfo.title="请登录"):($rootScope.userData.loginTitle=Tools.prototype.saveCookie($rootScope.code+"loginMobileNo"),$rootScope.userData.loginOut="退出",$rootScope.marketInfo.title="不使用")):($rootScope.userLoginId=$rootScope.uuid,Tools.prototype.saveCookie($rootScope.code+"randomId",null,{path:"/"}),Tools.prototype.saveCookie($rootScope.code+"randomId",$rootScope.uuid,{expires:30,path:"/"}),"micromessenger"==ua.match(/MicroMessenger/i)&&($rootScope.hasUuid=!0,Tools.prototype.saveCookie($rootScope.code+"hasUuid",null,{path:"/"}),Tools.prototype.saveCookie($rootScope.code+"hasUuid",$rootScope.hasUuid,{expires:30,path:"/"})))},$rootScope.$on("userIntercepted",function(e){$state.go("login",{from:$state.current.name})}),$rootScope.loginStatus(),$rootScope.login=function(){Tools.prototype.saveCookie($rootScope.code+"loginMobileNo",null,{path:"/"}),Tools.prototype.saveCookie($rootScope.code+"randomId",null,{path:"/"}),"退出"==$rootScope.userData.loginOut&&($cookieStore.remove($rootScope.code+"loginSeconds"),$cookieStore.remove($rootScope.code+"loginSecondTime")),$rootScope.initMarketInfo(),$rootScope.loginStatus(),$state.go("login")},$rootScope.goRecharge=function(){Tools.prototype.isEmpty($rootScope.code)||Tools.prototype.isEmpty($rootScope.menu)||(window.location.href="/mobile/mobilecommon/"+$rootScope.code+"?menu="+$rootScope.menu+"&randomId="+Tools.prototype.saveCookie($rootScope.code+"randomId")+"#/"+$rootScope.menu)},$rootScope.saveCookies=function(e,a){if("localOrder"==e){var o=Tools.prototype.saveCookie("localOrder");Tools.prototype.isEmpty(o)?Tools.prototype.saveCookie(e,a,{expires:30}):(Tools.prototype.saveCookie(e,null),o=a+";"+o,10<o.split(";").length&&(o=o.substring(0,o.lastIndexOf(";"))),Tools.prototype.saveCookie(e,o,{expires:30}))}else{var r=Tools.prototype.saveCookie(e);Tools.prototype.isEmpty(r)?Tools.prototype.saveCookie(e,a,{expires:30}):(-1==r.indexOf(a)&&(Tools.prototype.saveCookie(e,null),r=a+";"+r,5<r.split(";").length&&(r=r.substring(0,r.lastIndexOf(";")))),Tools.prototype.saveCookie(e,r,{expires:30}))}},$rootScope.showRechargeDesc=function(){$state.go("recharge-desc")},$rootScope.initMarketInfo=function(){$rootScope.marketInfo.userId="",$rootScope.marketInfo.faceValue="",$rootScope.marketInfo.cash="",$rootScope.marketInfo.title=Tools.prototype.isEmpty($rootScope.userLoginId)?"请登录":"不使用",$rootScope.marketInfo.billId=""},$rootScope.getDefaultMarketBill=function(e,a){if($rootScope.marketInfo.getDefaultFlag&&!Tools.prototype.isEmpty($rootScope.userLoginId)&&!Tools.prototype.isEmpty($rootScope.marketInfo.faceValue)){var o=[];MarketService.getMarketBills({code:$rootScope.code,userId:$rootScope.userLoginId},function(r){if("success"==r.message)if(angular.forEach(r.data,function(e,r){"psbc"==$rootScope.code?"0"==e.consumerState&&"1"==e.state&&-1!=$rootScope.marketInfo.category.indexOf(a)&&"OCP"==$rootScope.marketInfo.marketPayType&&parseFloat($rootScope.marketInfo.faceValue)<=parseFloat(e.cash)&&o.push(e):"0"==e.consumerState&&"1"==e.state&&-1!=a.indexOf(e.templateCateId)&&-1!=$rootScope.marketInfo.category.indexOf(e.templateCateId)&&("OCP"==$rootScope.marketInfo.marketPayType?parseFloat($rootScope.marketInfo.faceValue)<=parseFloat(e.cash)&&o.push(e):"OCP&OLP2"==$rootScope.marketInfo.marketPayType?parseFloat($rootScope.marketInfo.faceValue)==parseFloat(e.faceValue)&&o.push(e):parseFloat($rootScope.marketInfo.faceValue)>=parseFloat(e.faceValue)&&o.push(e))}),0<o.length){for(var t=o[0],c=1;c<o.length;c++)"OCP"==$rootScope.marketInfo.marketPayType?parseFloat(t.cash)>parseFloat(o[c].cash)&&(t=o[c]):parseFloat(t.cash)<parseFloat(o[c].cash)&&(t=o[c]);$rootScope.marketInfo.billId=t.billId,$rootScope.marketInfo.cash=t.cash,$rootScope.marketInfo.title="-"+t.cash+"元",e.setCash()}else $rootScope.marketInfo.billId="",$rootScope.marketInfo.cash="",$rootScope.marketInfo.title="不使用"})}},Tools.prototype.isEmpty($rootScope.noRouter)||$state.go($rootScope.menu)}}]),angular.bootstrap(document,["openwebApp"])}),define("app-mobile-standard",function(){});